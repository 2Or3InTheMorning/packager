{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/packager/brand.js","webpack:///./src/packager/downloader.worker.js","webpack:///./src/packager/checksum.worker.js","webpack:///./src/packager/lib/merge.js","webpack:///./src/packager/lib/serialize.js","webpack:///./src/packager/persistent-store.js","webpack:///./src/locales/index.js","webpack:///ComplexMessage.svelte","webpack:///Section.svelte","webpack:///Button.svelte","webpack:///./src/packager/stores.js","webpack:///./src/packager/errors.js","webpack:///./src/packager/lib/readers.js","webpack:///./src/packager/lib/xhr.js","webpack:///./src/packager/load-project.js","webpack:///./src/packager/lib/get-project-meta.js","webpack:///./src/packager/lib/url-utils.js","webpack:///SelectProject.svelte","webpack:///SelectLocale.svelte","webpack:///SelectTheme.svelte","webpack:///ImageInput.svelte","webpack:///CustomExtensions.svelte","webpack:///LearnMore.svelte","webpack:///./src/common/event-target.js","webpack:///./src/packager/images/default-icon.png","webpack:///./src/packager/large-assets.js","webpack:///./src/packager/lib/icns.js","webpack:///./src/packager/lib/build-id.js","webpack:///./src/packager/lib/idb.js","webpack:///./src/packager/cache.js","webpack:///./src/packager/lib/base85-encode.js","webpack:///./src/packager/lib/generate-asar.js","webpack:///./src/packager/lib/plist.js","webpack:///./src/packager/packager.js","webpack:///./src/packager/file-store.js","webpack:///./src/packager/preview.js","webpack:///./src/packager/lib/deep-clone.js","webpack:///PackagerOptions.svelte","webpack:///Progress.svelte","webpack:///./src/packager/lib/browser-support.js","webpack:///P4.svelte","webpack:///./src/packager/sw.js","webpack:///./src/packager/analytics.js","webpack:///./src/packager/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","APP_NAME","LONG_NAME","SOURCE_CODE","FEEDBACK_SCRATCH","FEEDBACK_GITHUB","WEBSITE","Worker","obj","Array","isArray","merge","into","from","typeInto","keys","serialize","defaultValue","Blob","v","serialized","a","b","areArraysEqual","JSON","parse","stringify","localValue","localStorage","getItem","store","subscribe","removeItem","setItem","allMessages","en","supportedLocales","navigator","language","toLowerCase","split","find","lang","set","documentElement","getProperty","id","parts","translate","locale","localMessages","el","values","build","firstChild","removeChild","part","createTextNode","node","href","textContent","text","warn","unsubscribe","then","caption","center","modal","accent","disabled","secondary","danger","progress","visible","reset","POSSIBLE_THEMES","theme","storedTheme","includes","UserError","readAsArrayBuffer","fr","FileReader","readAsURL","readAsDataURL","clampProgress","Math","max","min","url","progressCallback","estimatedSize","xhr","XMLHttpRequest","status","response","onprogress","lengthComputable","loaded","total","responseType","open","send","abort","downloadProject","async","buffer","worker","wrap","project","terminate","fromURL","file","title","extractProjectId","match","projectData","projectId","projectUrl","files","load","$progress","uniqueId","projectTitle","$_","replace","$type","$projectId","$projectUrl","str","URL","protocol","isValidURL","getTitleFromURL","$error","getDisplayedProjectURL","blur","select","entries","$locale","$theme","ACCEPT","dragging","previewSizes","revokeObjectURL","createObjectURL","stopPropagation","input","accept","join","addEventListener","body","click","remove","dataTransfer","types","preventDefault","droppedFile","some","ext","endsWith","customExtensions","map","filter","slug","this","_events","handler","handlers","fn","LARGE_ASSET_BASE","sha256","scaffolding","SCAFFOLDING_ROOT","useBuildId","addons","canvasToBlob","canvas","toBlob","blob","pngData","Icns","Buffer","pngDataBlob","image","Image","eligibleFormats","size","format","width","height","ctx","getContext","icns","formatSize","drawImage","arrayBuffer","icnsImage","IcnsImage","fromPNG","append","SCAFFOLDING_BUILD_ID","Database","version","storeName","db","indexedDB","userAgentData","test","userAgent","databases","intervalId","tryIdb","finally","setInterval","clearInterval","idbReady","onupgradeneeded","createObjectStore","keyPath","onsuccess","onopen","catch","readwrite","transaction","objectStore","createTransaction","setTransactionErrorHandler","openCursor","cursor","delete","continue","getAssetId","asset","allValidAssetIds","assetId","content","put","deleteEverything","decode","getValue","code","lengthEndsAt","indexOf","byteLength","substring","resultBuffer","ArrayBuffer","resultView","Uint32Array","charCodeAt","Uint8Array","header","offset","path","toString","headerPickle","createEmpty","writeString","headerBuffer","toBuffer","sizePickle","writeUInt32","sizeBuffer","totalSize","xmlToValue","tagName","child","children","nextElementSibling","valueToXml","doc","listItem","keyValue","keyNode","valueNode","string","rootDict","DOMParser","parseFromString","xml","implementation","createDocument","rootNode","XMLSerializer","serializeToString","escapeXML","getJSZip","default","setFileFast","zip","getAppIcon","SELF_LICENSE","homepage","license","SCRATCH_LICENSE","ELECTRON_LICENSE","COPYRIGHT_HEADER","generateChromiumLicenseHTML","licenses","index","super","options","DEFAULT_OPTIONS","dispatchProgress","dispatchEvent","CustomEvent","detail","cameFromCache","cached","buildId","source","verifyBuildId","hash","texts","analysis","usesMusic","fetchLargeAsset","chunks","gamepad","pointerlock","projectZip","nwjsBuffer","nwjsZip","loadAsync","isWindows","startsWith","isMac","isLinux","nwjsPrefix","packageName","app","newPath","icon","manifest","main","stageWidth","stageHeight","dataPrefix","icnsData","startScript","unixPermissions","creditsHtmlPath","creditsHtml","electronZip","TextEncoder","encode","appearance","background","appZip","newAppName","contentsPrefix","resourcePrefix","parsedBackgroundColor","parseInt","substr","applicationConfig","windowTitle","plist","cloudVariables","cloudHost","variables","custom","provider","Set","makeWebSocketProvider","makeLocalStorageProvider","variableName","providerToUse","extension","originalLength","newBuffer","originalView","newView","originalLengthAsString","resultIndex","getChar","floor","TextDecoder","progressWeight","PROGRESS_WAITING_FOR_VM_LOAD","PROGRESS_LOADED_JSON_BUT_NEED_ASSETS","loadResources","html","foreground","loadingScreen","imageMode","generateCursor","generateFavicon","progressBar","username","makeCustomProvider","controls","greenFlag","enabled","stopAll","fullscreen","turbo","interpolation","framerate","highQualityPen","fencing","miscLimits","maxClones","compiler","warpTimer","extensions","js","generateGetProjectData","autoplay","addNwJS","addElectron","addWebViewMac","generateAsync","compression","platform","meta","percent","filename","generateFilename","getDefaultPackageNameFromFileName","trim","getWindowTitleFromFileName","makeNamedBlob","cloneBlob","hasQueried","previewURL","windowToBlobMap","WeakMap","origin","location","preview","postMessage","close","deepClone","ALMOST_INFINITY","toFixed","stageVariables","isCloud","defaultOptions","variable","previewer","customCursorIcon","loadingScreenImage","otherEnvironmentsInitiallyOpen","$options","handleLargeAssetFetchProgress","thing","handleZipProgress","runPackager","packager","package","$icon","$customCursorIcon","$loadingScreenImage","setProgress","link","download","downloadURL","optionsClone","setContent","confirm","clear","reload","checked","embedding","onScratch","onGitHub","darkMedia","matchMedia","systemTheme","matches","closeModal","removeAttribute","hostname","doNotTrack","sendEvent","eventName","setRequestHeader","u","getElementById","serviceWorker","register","log"],"mappings":"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","file":"js/packager.9956b12070e82195fdff.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({\"0\":\"vendors~icns~jszip\",\"1\":\"icns\",\"2\":\"jszip\",\"4\":\"vendors~icns\",\"5\":\"vendors~jszip\"}[chunkId]||chunkId) + \".\" + {\"0\":\"32af4fcb211f4f5d575c\",\"1\":\"99160bc8e868d7772abe\",\"2\":\"8063d2d082fa04495905\",\"4\":\"8ae8c1b61a5d2cf973c0\",\"5\":\"4ec4f8740336d39a1983\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([30,6]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Use old export to make this easier to import in old node environments\nmodule.exports = {\n  APP_NAME: 'TurboWarp Packager',\n  LONG_NAME: 'TurboWarp Packager for Scratch',\n  SOURCE_CODE: 'https://github.com/TurboWarp/packager',\n  FEEDBACK_SCRATCH: 'https://scratch.mit.edu/users/GarboMuffin/#comments',\n  FEEDBACK_GITHUB: 'https://github.com/TurboWarp/packager/issues',\n  WEBSITE: 'https://packager.turbowarp.org/'\n};\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"downloader.worker.js\");\n};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"checksum.worker.js\");\n};","const type = (obj) => {\n  if (obj === null) return 'null';\n  if (Array.isArray(obj)) return 'array';\n  return typeof obj;\n};\n\nconst merge = (into, from) => {\n  const typeInto = type(into);\n  const typeFrom = type(from);\n  if (typeInto !== typeFrom || typeInto === 'undefined') {\n    return from;\n  }\n  if (typeInto === 'object') {\n    for (const key of Object.keys(from)) {\n      into[key] = merge(into[key], from[key]);\n    }\n    for (const key of Object.keys(into)) {\n      if (!Object.prototype.hasOwnProperty.call(from, key)) {\n        delete into[key];\n      }\n    }\n  }\n  return into;\n};\n\nexport default merge;\n","const isObject = (v) => !!v && typeof v === 'object' && !Array.isArray(v);\n\nconst areArraysEqual = (a, b) => {\n  if (a.length !== b.length) {\n    return false;\n  }\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n};\n\n/**\n * @returns {*|null} null means \"do not store\"\n */\nconst serialize = (value, defaultValue) => {\n  // Never serialize blobs.\n  if (value instanceof Blob) {\n    return null;\n  }\n  if (isObject(defaultValue)) {\n    const result = {};\n    for (const key of Object.keys(defaultValue)) {\n      if (!Object.prototype.hasOwnProperty.call(value, key)) {\n        continue;\n      }\n      const serialized = serialize(value[key], defaultValue[key]);\n      if (serialized !== null) {\n        result[key] = serialized;\n      }\n    }\n    if (Object.keys(result).length === 0) {\n      return null;\n    }\n    return result;\n  }\n  if (Array.isArray(value)) {\n    if (Array.isArray(defaultValue)) {\n      if (areArraysEqual(value, defaultValue)) {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n  if (value === defaultValue) {\n    return null;\n  }\n  return value;\n};\n\nexport default serialize;\n","import {writable} from 'svelte/store';\nimport merge from './lib/merge';\nimport serialize from './lib/serialize';\n\nconst writablePersistentStore = (key, defaultValue) => {\n  let value = JSON.parse(JSON.stringify(defaultValue));\n  const localValue = JSON.parse(localStorage.getItem(key));\n  if (localValue) {\n    value = merge(localValue, value);\n  }\n  const store = writable(value, () => {\n    const unsubscribe = store.subscribe(value => {\n      const serialized = serialize(value, defaultValue);\n      if (serialized === null) {\n        localStorage.removeItem(key);\n      } else {\n        localStorage.setItem(key, JSON.stringify(serialized));\n      }\n    });\n    return unsubscribe;\n  });\n  return store;\n};\n\nexport default writablePersistentStore;\n","import {derived} from 'svelte/store';\nimport writablePersistentStore from '../packager/persistent-store';\nimport englishMessages from '!../build/unstructure-translations-loader!./en.json';\nimport localeNames from './locale-names.json';\n\nconst allMessages = {\n  en: () => englishMessages,\n  // Generated code:\n  /*===*/\n  \"de\": () => require(\"./de.json\"),\n  \"es\": () => require(\"./es.json\"),\n  \"it\": () => require(\"./it.json\"),\n  \"ja\": () => require(\"./ja.json\"),\n  \"ko\": () => require(\"./ko.json\"),\n  \"pl\": () => require(\"./pl.json\"),\n  \"pt\": () => require(\"./pt.json\"),\n  \"ru\": () => require(\"./ru.json\"),\n  \"sl\": () => require(\"./sl.json\"),\n  \"sv\": () => require(\"./sv.json\"),\n  \"tr\": () => require(\"./tr.json\"),\n  \"zh-cn\": () => require(\"./zh-cn.json\"),\n  \"zh-tw\": () => require(\"./zh-tw.json\"),\n  /*===*/\n};\n\nconst supportedLocales = {};\n// Iterate over localeNames to preserve order\nfor (const key of Object.keys(localeNames)) {\n  if (allMessages[key]) {\n    supportedLocales[key] = localeNames[key];\n  }\n}\n\nconst getInitialLocale = () => [\n  navigator.language.toLowerCase(),\n  navigator.language.toLowerCase().split('-')[0]\n].find(i => allMessages[i]) || 'en';\n\nconst locale = writablePersistentStore('P4.locale', getInitialLocale());\nlocale.subscribe((lang) => {\n  if (!allMessages[lang]) {\n    locale.set('en');\n  }\n  document.documentElement.lang = lang;\n});\n\nconst getProperty = (obj, id) => {\n  const parts = id.split('.');\n  for (let i = 0; i < parts.length - 1; i++) {\n    obj = obj[parts[i]];\n    if (!obj) {\n      return null;\n    }\n  }\n  return obj[parts[parts.length - 1]] || null;\n};\n\nconst translate = derived(locale, (locale) => {\n  const localMessages = allMessages[locale]();\n  /**\n   * @param {string} id Message ID\n   * @returns {string} Translated message\n   */\n  return (id) => {\n    return getProperty(localMessages, id) || getProperty(englishMessages, id) || id;\n  };\n});\n\nexport {\n  locale,\n  supportedLocales,\n  translate as _\n};\n","<script>\n  import {onMount, onDestroy, tick} from 'svelte';\n  import {_} from '../locales/index';\n\n  export let message;\n  export let values;\n  let el;\n\n  const build = () => {\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n    const parts = message.split(/{(\\w+)}/g);\n    for (let i = 0; i < parts.length; i++) {\n      const part = parts[i];\n      const isText = i % 2 === 0;\n      if (isText) {\n        el.appendChild(document.createTextNode(part));\n      } else {\n        const value = values[part];\n        if (value) {\n          const node = document.createElement('a');\n          node.href = value.href;\n          node.textContent = value.text;\n          el.appendChild(node);\n        } else {\n          console.warn('Missing placeholder', part);\n          el.appendChild(document.createTextNode(`???{${part}}`));\n        }\n      }\n    }\n  };\n\n  const unsubscribe = _.subscribe(() => {\n    if (el) {\n      // message props don't get updated until after tick\n      tick().then(build);\n    }\n  });\n\n  onMount(build);\n  onDestroy(unsubscribe);\n</script>\n\n<span bind:this={el}></span>\n","<script>\n  export let caption = false;\n  export let center = false;\n  export let modal = false;\n  export let accent = '';\n</script>\n\n<style>\n  .card {\n    max-width: 600px;\n    margin: auto;\n    border-radius: 0.3em;\n    background-color: #fff;\n    padding: 1em;\n    margin-top: 1em;\n    margin-bottom: 1em;\n    box-shadow: 0 2px 0.5em 0.1em rgba(0, 0, 0, 0.2);\n  }\n  :global([theme=\"dark\"]) .card {\n    background: #222;\n  }\n  .caption {\n    font-style: italic;\n  }\n  .modal {\n    width: 100%;\n    max-width: 400px;\n    margin: 0 8px;\n  }\n  .center {\n    height: 40px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n</style>\n\n<div class=\"card\" class:caption class:modal class:center={caption || center} style={accent ? `border-top: 6px solid ${accent}` : ''}>\n  <slot></slot>\n</div>\n","<script>\n  export let disabled;\n  export let secondary;\n  export let danger;\n  export let text;\n</script>\n\n<style>\n  button {\n    font-family: inherit;\n    font-size: 14px;\n    background-color: #ff4c4c;\n    color: white;\n    border: none;\n    padding: 0.5rem 1rem;\n    margin: 0;\n    border-radius: 4px;\n    cursor: pointer;\n    font-family: inherit;\n    font-weight: bold;\n  }\n  button:active {\n    background-color: #b92828;\n  }\n  button:disabled {\n    background-color: #ff9797;\n    cursor: not-allowed;\n  }\n  .secondary {\n    background-color: #0FBD8C;\n  }\n  .secondary:active {\n    background-color: #03946b;\n  }\n  .secondary:disabled {\n    background-color: #57dbb6;\n  }\n  .danger {\n    background-color: #FF8C1A;\n  }\n  .danger:active {\n    background-color: #c76c12;\n  }\n  .danger:disabled {\n    background-color: #ffbd7b;\n  }\n</style>\n\n<button on:click disabled={disabled} class:secondary class:danger>\n  {text}\n</button>\n","import {writable} from 'svelte/store';\n\nconst error = writable(null);\nconst progress = writable({\n  progress: 0,\n  visible: false,\n  text: ''\n});\nprogress.reset = () => {\n  progress.set({\n    progress: 0,\n    visible: false,\n    text: ''\n  });\n};\n\nconst POSSIBLE_THEMES = [\n  'system',\n  'dark',\n  'light'\n];\nconst THEME_KEY = 'P4.theme';\nconst theme = writable('system');\ntry {\n  const storedTheme = localStorage.getItem(THEME_KEY);\n  if (POSSIBLE_THEMES.includes(storedTheme)) {\n    theme.set(storedTheme);\n  }\n} catch (e) {\n  // Ignore\n}\ntheme.subscribe((value) => {\n  try {\n    if (value === 'system') {\n      localStorage.removeItem(THEME_KEY);\n    } else {\n      localStorage.setItem(THEME_KEY, value);\n    }\n  } catch (e) {\n    // ignore\n  }\n});\n\nexport {\n  error,\n  progress,\n  theme\n};\n","/**\n * A type of Error that indicates that the user has configured something wrong, and this error is not a bug.\n */\nclass UserError extends Error {\n\n}\n\nexport {\n  UserError\n};\n","export const readAsArrayBuffer = (o) => new Promise((resolve, reject) => {\n  const fr = new FileReader();\n  fr.onload = () => resolve(fr.result);\n  fr.onerror = () => reject(new Error(`Cannot read as array buffer: ${fr.error}`));\n  fr.readAsArrayBuffer(o);\n});\n\nexport const readAsURL = (o) => new Promise((resolve, reject) => {\n  const fr = new FileReader();\n  fr.onload = () => resolve(fr.result);\n  fr.onerror = () => reject(new Error(`Cannot read as URL: ${fr.error}`));\n  fr.readAsDataURL(o);\n});\n","const clampProgress = (n) => Math.max(0, Math.min(1, n));\n\nconst xhr = ({\n  url,\n  type,\n  progressCallback,\n  timeout,\n  estimatedSize\n}) => new Promise((resolve, reject) => {\n  const xhr = new XMLHttpRequest();\n  xhr.onload = () => {\n    if (xhr.status === 200) {\n      resolve(xhr.response);\n    } else {\n      reject(new Error(`Request failed with status code: ${xhr.status}`));\n    }\n  };\n  xhr.onerror = () => {\n    reject(new Error('Request failed, are you offline?'));\n  };\n  if (progressCallback) {\n    xhr.onprogress = (e) => {\n      if (e.lengthComputable) {\n        progressCallback(clampProgress(e.loaded / e.total));\n      } else if (estimatedSize) {\n        progressCallback(clampProgress(e.loaded / estimatedSize));\n      }\n    };\n  }\n  xhr.responseType = type;\n  xhr.open('GET', url);\n  xhr.send();\n  if (timeout) {\n    setTimeout(() => {\n      xhr.abort();\n      reject(new Error('Request timed out'));\n    }, timeout);\n  }\n});\n\nexport default xhr;\n","import * as Comlink from 'comlink';\nimport DownloadWorker from 'worker-loader?name=downloader.worker.js!./downloader.worker.js';\nimport {readAsArrayBuffer} from './lib/readers';\nimport xhr from './lib/xhr';\n\nconst downloadProject = async (buffer, progressCallback) => {\n  const worker = new DownloadWorker();\n  const wrap = Comlink.wrap(worker);\n  const project = await wrap.downloadProject(Comlink.transfer(buffer, [buffer]), Comlink.proxy(progressCallback));\n  worker.terminate();\n  return project;\n};\n\nconst fromURL = async (url, progressCallback) => {\n  const buffer = await xhr({\n    url,\n    type: 'arraybuffer',\n    progressCallback: (progress) => {\n      progressCallback('fetch', progress);\n    }\n  });\n  return downloadProject(buffer, progressCallback);\n};\n\nconst fromID = (id, progressCallback) => fromURL(`https://projects.scratch.mit.edu/${id}`, progressCallback);\n\nconst fromFile = async (file, progressCallback) => {\n  const buffer = await readAsArrayBuffer(file);\n  return downloadProject(buffer, progressCallback);\n};\n\nexport default {\n  fromID,\n  fromURL,\n  fromFile\n};\n","import xhr from './xhr';\n\nconst getProjectTitle = async (id) => {\n  try {\n    const meta = await xhr({\n      url: `https://trampoline.turbowarp.org/proxy/projects/${id}`,\n      timeout: 10000,\n      type: 'json'\n    });\n    return meta.title;\n  } catch (e) {\n    // Happens commonly when loading unshared projects, not something to worry about\n    return '';\n  }\n};\n\nexport default getProjectTitle;\n","export const extractProjectId = (text) => {\n  const match = text.match(/\\d+/);\n  if (!match) {\n    return '';\n  }\n  return match[0];\n};\n\nexport const isValidURL = (str) => {\n  try {\n    const url = new URL(str);\n    return url.protocol === 'http:' || url.protocol === 'https:';\n  } catch (e) {\n    return false;\n  }\n};\n\nexport const getTitleFromURL = (url) => {\n  const match = url.match(/\\/([^\\/]+)\\.sb[2|3]?$/);\n  if (match) {\n    return match[1];\n  }\n  return '';\n};\n","<script>\n  import {_} from '../locales/';\n  import Section from './Section.svelte';\n  import Button from './Button.svelte';\n  import writablePersistentStore from './persistent-store';\n  import {error, progress} from './stores';\n  import {UserError} from './errors';\n  import loadProject from './load-project';\n  import getProjectTitle from './lib/get-project-meta.js';\n  import {extractProjectId, isValidURL, getTitleFromURL} from './lib/url-utils';\n\n  export let projectData = null;\n  const type = writablePersistentStore('SelectProject.type', 'id');\n  const projectId = writablePersistentStore('SelectProject.id', '60917032');\n  const projectUrl = writablePersistentStore('SelectProject.url', '');\n  let files = null;\n\n  const reset = () => {\n    projectData = null;\n  };\n\n  // Reset project whenever an input changes\n  $: files, $projectId, $type, reset();\n\n  const load = async () => {\n    if ($progress.visible) {\n      // Already running something\n      return;\n    }\n\n    try {\n      reset();\n      $progress.visible = true;\n\n      let uniqueId = '';\n      let id = null;\n      let projectTitle = '';\n      let project;\n\n      const progressCallback = (type, a, b) => {\n        if (type === 'fetch') {\n          $progress.progress = a;\n        } else if (type === 'assets') {\n          $progress.text = $_('progress.loadingAssets')\n            .replace('{complete}', a)\n            .replace('{total}', b);\n          $progress.progress = a / b;\n        } else if (type === 'compress') {\n          $progress.text = $_('progress.compressingProject');\n          $progress.progress = a;\n        }\n      };\n\n      if ($type === 'id') {\n        id = $projectId;\n        if (!id) {\n          throw new UserError($_('select.invalidId'));\n        }\n        uniqueId = `#${id}`;\n        $progress.text = $_('progress.loadingProjectData');\n        [projectTitle, project] = await Promise.all([\n          getProjectTitle(id),\n          loadProject.fromID(id, progressCallback)\n        ]);\n      } else if ($type === 'file') {\n        if (!files) {\n          throw new UserError($_('select.noFileSelected'));\n        }\n        const file = files[0];\n        uniqueId = `@${file.name}`;\n        projectTitle = file.name;\n        $progress.text = $_('progress.compressingProject');\n        project = await loadProject.fromFile(file, progressCallback);\n      } else if ($type === 'url') {\n        const url = $projectUrl;\n        if (!isValidURL(url)) {\n          throw new UserError($_('select.invalidUrl'));\n        }\n        uniqueId = `$${url}`;\n        $progress.text = $_('progress.loadingProjectData');\n        projectTitle = getTitleFromURL(url);\n        project = await loadProject.fromURL(url, progressCallback);\n      } else {\n        throw new Error('Unknown type');\n      }\n\n      projectData = {\n        projectId: id,\n        uniqueId,\n        title: projectTitle,\n        project,\n      };\n    } catch (e) {\n      $error = e;\n    }\n\n    progress.reset();\n  };\n\n  // just incase some non-number string was stored from older versions\n  $projectId = extractProjectId($projectId);\n\n  const getDisplayedProjectURL = () => `https://scratch.mit.edu/projects/${$projectId}`;\n\n  const submitOnEnter = (e) => {\n    if (e.key === 'Enter') {\n      e.target.blur();\n      load();\n    }\n  };\n  const handleInput = (e) => {\n    $projectId = extractProjectId(e.target.value);\n    e.target.value = getDisplayedProjectURL();\n  };\n  const handleFocus = (e) => {\n    e.target.select();\n  };\n</script>\n\n<style>\n  input[type=\"text\"] {\n    max-width: 300px;\n    flex-grow: 1;\n  }\n  .option {\n    min-height: 25px;\n    display: flex;\n    align-items: center;\n  }\n  input[type=\"text\"], input[type=\"file\"] {\n    margin-left: 4px;\n  }\n</style>\n\n<Section accent=\"#4C97FF\">\n  <h2>{$_('select.select')}</h2>\n  <p>{$_('select.selectHelp')}</p>\n  <div class=\"option\">\n    <label>\n      <input type=\"radio\" bind:group={$type} value=\"id\">\n      {$_('select.id')}\n    </label>\n    {#if $type === \"id\"}\n      <input type=\"text\" value={getDisplayedProjectURL()} spellcheck=\"false\" on:keypress={submitOnEnter} on:input={handleInput} on:focus={handleFocus}>\n    {/if}\n  </div>\n  <div class=\"option\">\n    <label>\n      <input type=\"radio\" bind:group={$type} value=\"file\">\n      {$_('select.file')}\n    </label>\n    {#if $type === \"file\"}\n      <input bind:files={files} type=\"file\" accept=\".sb,.sb2,.sb3\">\n    {/if}\n  </div>\n  <div class=\"option\">\n    <label>\n      <input type=\"radio\" bind:group={$type} value=\"url\">\n      {$_('select.url')}\n    </label>\n    {#if $type === \"url\"}\n      <input type=\"text\" bind:value={$projectUrl} spellcheck=\"false\" placeholder=\"https://...\" on:keypress={submitOnEnter}>\n    {/if}\n  </div>\n\n  <p>\n    <Button on:click={load} disabled={$progress.visible} text={$_('select.loadProject')} />\n  </p>\n</Section>\n\n{#if !$progress.visible && !projectData}\n  <Section caption>\n    <p>{$_('select.loadToContinue')}</p>\n  </Section>\n{/if}\n","<script>\n  import {locale, supportedLocales} from '../locales/index';\n</script>\n\n<select bind:value={$locale}>\n  {#each Object.entries(supportedLocales) as [locale, {name}]}\n    <option value={locale}>{name}</option>\n  {/each}\n</select>\n","<script>\n  import {theme} from './stores';\n  import {_} from '../locales';\n</script>\n\n<select bind:value={$theme}>\n  <option value=\"system\">{$_('theme.system')}</option>\n  <option value=\"light\">{$_('theme.light')}</option>\n  <option value=\"dark\">{$_('theme.dark')}</option>\n</select>\n","<script>\n  import {_} from '../locales';\n\n  const ACCEPT = [\n    '.png',\n    '.jpg',\n    '.jpeg',\n    '.bmp',\n    '.svg',\n    '.ico',\n    '.gif'\n  ];\n\n  export let file;\n  export let previewSizes;\n  let dragging;\n  let url;\n\n  // This is a bit strange, there's probably a better way to do this\n  // Seems to create and revoke an extra object URL for each file for some reason\n  $: if (file) {\n    if (url) {\n      URL.revokeObjectURL(url);\n    }\n    url = URL.createObjectURL(file);\n  } else if (url) {\n    URL.revokeObjectURL(url);\n    url = null;\n  }\n\n  const clear = (e) => {\n    e.stopPropagation();\n    file = null;\n  };\n\n  const handleClickBackground = () => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = ACCEPT.join(',');\n    input.addEventListener('change', (e) => {\n      const files = e.target.files;\n      if (files.length) {\n        file = files[0];\n      } else {\n        file = null;\n      }\n    });\n    document.body.appendChild(input);\n    input.click();\n    input.remove();\n  };\n\n  const handleDragOver = (e) => {\n    if (!e.dataTransfer.types.includes('Files')) {\n      return;\n    }\n    e.preventDefault();\n    dragging = true;\n  };\n\n  const handleDragLeave = (e) => {\n    e.preventDefault();\n    dragging = false;\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    dragging = false;\n    if (e.dataTransfer.types.includes('Files')) {\n      const droppedFile = e.dataTransfer.files[0];\n      if (droppedFile && ACCEPT.some((ext) => droppedFile.name.endsWith(ext))) {\n        file = droppedFile;\n      }\n    }\n  };\n</script>\n\n<style>\n  .container {\n    color: #555;\n    width: 100%;\n    box-sizing: border-box;\n    border: 3px dashed currentColor;\n    transition: .2s border-color, .2s color;\n    border-radius: 20px;\n    min-height: 90px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    overflow: hidden;\n    user-select: none;\n    position: relative;\n    cursor: pointer;\n    padding: 4px;\n  }\n  :global([theme=\"dark\"]) .container {\n    color: #aaa;\n  }\n  .dragging,\n  .container:focus-visible,\n  .container:active {\n    color: rgb(79, 123, 211);\n  }\n  :global([theme=\"dark\"]) .dragging,\n  :global([theme=\"dark\"]) .container:focus-visible,\n  :global([theme=\"dark\"]) .container:active {\n    color: rgb(178, 195, 228);\n  }\n  .placeholder {\n    font-size: 1.5em;\n  }\n  .selected {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-wrap: wrap;\n  }\n  .selected > *:not(:last-child) {\n    margin-right: 12px;\n  }\n</style>\n\n<div\n  class=\"container\"\n  class:dragging\n  role=\"button\"\n  tabindex=\"0\"\n  on:click={handleClickBackground}\n  on:dragover={handleDragOver}\n  on:dragleave={handleDragLeave}\n  on:drop={handleDrop}\n>\n  {#if file}\n    <div class=\"selected\">\n      {#each previewSizes as size}\n        <!-- svelte-ignore a11y-missing-attribute -->\n        <img src={url} width={size[0]} height={size[1]}>\n      {/each}\n      <div>{$_('fileInput.selected').replace('{file}', file.name)}</div>\n      <button on:click={clear}>{$_('fileInput.clear')}</button>\n    </div>\n  {:else}\n    <div class=\"placeholder\">{$_('fileInput.select')}</div>\n  {/if}\n</div>\n","<script>\n  export let value;\n\n  let customExtensions = value.map(i => i.url).join('\\n');\n  $: value = customExtensions.split('\\n').filter(i => i).map(i => ({url: i}));\n</script>\n\n<style>\n  textarea {\n    box-sizing: border-box;\n    width: 100%;\n    min-width: 100%;\n    height: 100px;\n  }\n</style>\n\n<textarea bind:value={customExtensions}></textarea>\n","<script>\n  export let slug;\n</script>\n\n<style>\n  a {\n    text-decoration: none;\n  }\n  a:hover {\n    text-decoration: underline;\n  }\n</style>\n\n<a href={`https://docs.turbowarp.org/${slug}`} title=\"Learn more\" target=\"_blank\" rel=\"noopener noreferrer\">(?)</a>\n","class EventTargetShim {\n  constructor () {\n    this._events = {};\n  }\n\n  addEventListener (event, handler) {\n    if (!this._events[event]) {\n      this._events[event] = [];\n    }\n    this._events[event].push(handler);\n  }\n\n  removeEventListener (event, handler) {\n    const handlers = this._events[event];\n    if (handlers) {\n      this._events[event] = handlers.filter(i => i !== handler);\n    }\n  }\n\n  dispatchEvent (event) {\n    const handlers = this._events[event.type];\n    if (handlers) {\n      for (const fn of handlers) {\n        fn(event);\n      }\n    }\n  }\n}\n\nexport default EventTargetShim;\n","export default __webpack_public_path__ + \"assets/default-icon.290e09e569a1cab8e61ba93b0d23863f.png\";","const LARGE_ASSET_BASE = 'https://packagerdata.turbowarp.org/';\nconst SCAFFOLDING_ROOT = 'scaffolding/';\n\nexport default {\n  'nwjs-win64': {\n    src: LARGE_ASSET_BASE + 'nwjs-v0.54.0-win-x64.zip',\n    sha256: '0f082671b67b711f783d98cc989cf5aebacfc9bce3bef78875b57d08fc2a6e86',\n    type: 'arraybuffer'\n  },\n  'nwjs-win32': {\n    src: LARGE_ASSET_BASE + 'nwjs-v0.54.0-win-ia32.zip',\n    sha256: '7a1ed3a6a51b8cdf9280761b90cb4723cf9ee8050e3ed0b58451e8e4e694b203',\n    type: 'arraybuffer'\n  },\n  'nwjs-mac': {\n    src: LARGE_ASSET_BASE + 'nwjs-v0.54.0-osx-x64.zip',\n    sha256: '498c97a264f8feac504c4c2396c1fddc8290c15573aee2fc692e59ff9803cc40',\n    type: 'arraybuffer'\n  },\n  'nwjs-linux-x64': {\n    src: LARGE_ASSET_BASE + 'nwjs-v0.54.0-linux-x64.zip',\n    sha256: '53651a3a12d29ad096cff5b44d9f1e3aa09e9fad970bdcfe8bda07ea23d960d8',\n    type: 'arraybuffer'\n  },\n  'electron-win32': {\n    src: LARGE_ASSET_BASE + 'electron-v13.1.6-win32-ia32.zip',\n    sha256: 'bb6f34548879c9813897e2b023d195bf8b735198687db4448e19a13f71d77766',\n    type: 'arraybuffer'\n  },\n  'electron-linux64': {\n    src: LARGE_ASSET_BASE + 'electron-v13.1.6-linux-x64.zip',\n    sha256: '6f28af0a3ccb20b0d2e4f26ea4698d5b89b81e860cbd40a446c2a8223fdf0101',\n    type: 'arraybuffer'\n  },\n  'webview-mac': {\n    src: LARGE_ASSET_BASE + 'WebView-macos-2.zip',\n    sha256: '78990872aec9d1fc55d26897e5f7dd1b8b21237ffa8b19dfca69ec47d18ece90',\n    type: 'arraybuffer'\n  },\n  scaffolding: {\n    src: SCAFFOLDING_ROOT + 'scaffolding.js',\n    estimatedSize: 4775503,\n    useBuildId: true,\n    type: 'text'\n  },\n  'scaffolding-min': {\n    src: SCAFFOLDING_ROOT + 'scaffolding-min.js',\n    estimatedSize: 2540321,\n    useBuildId: true,\n    type: 'text'\n  },\n  addons: {\n    src: SCAFFOLDING_ROOT + 'addons.js',\n    estimatedSize: 14339,\n    useBuildId: true,\n    type: 'text'\n  }\n};\n","import {readAsArrayBuffer} from './readers';\n\nconst loadImage = (src) => new Promise((resolve, reject) => {\n  const image = new Image();\n  image.onload = () => resolve(image);\n  image.onerror = () => reject(new Error(`Could not load image: ${src}`));\n  image.src = src;\n});\n\nconst canvasToBlob = (canvas) => new Promise((resolve, reject) => {\n  canvas.toBlob((blob) => {\n    if (blob) {\n      resolve(blob);\n    } else {\n      reject(new Error('Could not read <canvas> as blob'));\n    }\n  });\n});\n\nconst pngToAppleICNS = async (pngData) => {\n  const {\n    Icns,\n    Buffer\n  } = await import(/* webpackChunkName: \"icns\" */ './icns-bundle');\n\n  const FORMATS = [\n    { type: 'ic04', size: 16 },\n    { type: 'ic07', size: 128 },\n    { type: 'ic08', size: 256 },\n    { type: 'ic09', size: 512 },\n    { type: 'ic10', size: 1024 },\n    { type: 'ic11', size: 32 },\n    { type: 'ic12', size: 64 },\n    { type: 'ic13', size: 256 },\n    { type: 'ic14', size: 512 },\n  ];\n\n  // Read the Image.\n  const pngDataBlob = new Blob([pngData], {\n    type: 'image/png'\n  });\n  const url = URL.createObjectURL(pngDataBlob);\n  const image = await loadImage(url);\n\n  // Determine the formats to create\n  const eligibleFormats = FORMATS.filter((format) => {\n    // Always include the smallest size so that tiny images will get at least 1 image.\n    if (format.size === 16) {\n      return true;\n    }\n    return image.width >= format.size && image.height >= format.size;\n  });\n\n  // Create a single canvas to be used for conversion\n  // Creating many canvases is prone to error in Safari\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    throw new Error('cannot get canvas rendering context');\n  }\n\n  const icns = new Icns.Icns();\n  for (const format of eligibleFormats) {\n    // Use the canvas to scale the image.\n    const formatSize = format.size;\n    canvas.width = formatSize;\n    canvas.height = formatSize;\n    ctx.drawImage(image, 0, 0, formatSize, formatSize);\n\n    const blob = await canvasToBlob(canvas);\n    const arrayBuffer = await readAsArrayBuffer(blob);\n    const icnsImage = await Icns.IcnsImage.fromPNG(Buffer.from(arrayBuffer), format.type);\n    icns.append(icnsImage);\n  }\n\n  return icns.data;\n};\n\nexport default pngToAppleICNS;\n","const SCAFFOLDING_BUILD_ID = process.env.SCAFFOLDING_BUILD_ID;\n\nconst verifyBuildId = (buildId, source) => {\n  if (source.endsWith('=^..^=')) {\n    return source.endsWith(`${buildId} =^..^=`);\n  }\n  return true;\n};\n\nexport {\n  SCAFFOLDING_BUILD_ID as buildId,\n  verifyBuildId\n};\n","// https://github.com/jakearchibald/safari-14-idb-fix/blob/582bbdc7230891113bfb5743391550cbf29d21f2/src/index.ts\nconst idbReady = () => {\n  const isSafari =\n    !navigator.userAgentData &&\n    /Safari\\//.test(navigator.userAgent) &&\n    !/Chrom(e|ium)\\//.test(navigator.userAgent);\n\n  // No point putting other browsers or older versions of Safari through this mess.\n  if (!isSafari || !indexedDB.databases) return Promise.resolve();\n\n  let intervalId;\n  return new Promise((resolve) => {\n    const tryIdb = () => indexedDB.databases().finally(resolve);\n    intervalId = setInterval(tryIdb, 100);\n    tryIdb();\n  }).finally(() => clearInterval(intervalId));\n};\n\nclass Database {\n  constructor (name, version, storeName) {\n    this.name = name;\n    this.version = version;\n    this.storeName = storeName;\n    this.db = null;\n  }\n\n  async open () {\n    if (this.db) {\n      return this.db;\n    }\n    if (!window.indexedDB) {\n      throw new Error('indexedDB is not supported');\n    }\n    await idbReady();\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open(this.name, this.version);\n      request.onupgradeneeded = (e) => {\n        const db = e.target.result;\n        db.createObjectStore(this.storeName, {\n          keyPath: 'id'\n        });\n      };\n      request.onsuccess = (e) => {\n        this.db = e.target.result;\n        this.onopen()\n          .then(() => {\n            resolve(this.db);\n          })\n          .catch((err) => {\n            reject(err);\n          });\n      };\n      request.onerror = (e) => {\n        reject(new Error(`IDB Error ${e.target.error}`));\n      };\n    });\n  }\n\n  async createTransaction (readwrite) {\n    const db = await this.open();\n    const transaction = db.transaction(this.storeName, readwrite);\n    const store = transaction.objectStore(this.storeName);\n    return {\n      db,\n      transaction,\n      store\n    };\n  }\n\n  async deleteEverything () {\n    const {transaction, store} = await this.createTransaction('readwrite');\n    return new Promise((resolve, reject) => {\n      Database.setTransactionErrorHandler(transaction, reject);\n      const request = store.openCursor();\n      request.onsuccess = e => {\n        const cursor = e.target.result;\n        if (cursor) {\n          cursor.delete();\n          cursor.continue();\n        } else {\n          resolve();\n        }\n      };\n    });\n  }\n\n  onopen () {\n    return Promise.resolve();\n  }\n}\n\nDatabase.setTransactionErrorHandler = (transaction, reject) => {\n  transaction.onerror = () => {\n    reject(new Error(`Transaction error: ${transaction.error}`))\n  };\n};\n\nexport default Database;\n","import largeAssets from './large-assets';\nimport {buildId} from './lib/build-id';\nimport Database from './lib/idb';\n\n// We can't trust the HTTP cache to reliably cache these large assets\n\nconst DATABASE_NAME = 'p4-large-assets';\nconst DATABASE_VERSION = 1;\nconst STORE_NAME = 'assets';\n\nconst db = new Database(DATABASE_NAME, DATABASE_VERSION, STORE_NAME);\n\nconst getAssetId = (asset) => {\n  return `${asset.src}-${asset.type}-${asset.sha256 || buildId}`;\n};\n\nconst removeExtraneous = async () => {\n  const {transaction, store} = await db.createTransaction('readwrite');\n  return new Promise((resolve, reject) => {\n    Database.setTransactionErrorHandler(transaction, reject);\n    const allValidAssetIds = Object.values(largeAssets).map(getAssetId);\n    const request = store.openCursor();\n    request.onsuccess = e => {\n      const cursor = e.target.result;\n      if (cursor) {\n        const key = cursor.key;\n        if (!allValidAssetIds.includes(key)) {\n          cursor.delete();\n        }\n        cursor.continue();\n      } else {\n        resolve();\n      }\n    };\n  });\n};\ndb.onopen = removeExtraneous;\n\nconst get = async (asset) => {\n  const {transaction, store} = await db.createTransaction('readonly');\n  return new Promise((resolve, reject) => {\n    Database.setTransactionErrorHandler(transaction, reject);\n    const assetId = getAssetId(asset);\n    const request = store.get(assetId);\n    request.onsuccess = (e) => {\n      const result = e.target.result;\n      if (result) {\n        resolve(result.data);\n      } else {\n        resolve(null);\n      }\n    };\n  });\n};\n\nconst set = async (asset, content) => {\n  const {transaction, store} = await db.createTransaction('readwrite');\n  return new Promise((resolve, reject) => {\n    Database.setTransactionErrorHandler(transaction, reject);\n    const assetId = getAssetId(asset);\n    const request = store.put({\n      id: assetId,\n      data: content\n    });\n    request.onsuccess = () => {\n      resolve();\n    };\n  });\n};\n\nconst resetAll = () => db.deleteEverything();\n\nexport default {\n  get,\n  set,\n  resetAll\n};\n","// This implements a custom base85 encoding for improved efficiency compared to base64\n// The character set used is 0x2a - 0x7e of ASCII\n// 0x3c (<) is replaced with 0x28 (opening parenthesis) and 0x3e (>) is replaced with 0x29 (closing parenthesis)\n// Encoded data can be safely included in HTML without escapes\n\n// It's possible these functions will be stringified at runtime to be included in generated code,\n// so make sure that they're entirely self contained\n\n/**\n * @param {ArrayBuffer} buffer The data to encode\n * @returns {string} Encoded string\n */\nexport const encode = (buffer) => {\n  const originalLength = buffer.byteLength;\n  let data;\n  if (originalLength % 4 !== 0) {\n    const newBuffer = new ArrayBuffer(originalLength + (4 - originalLength % 4));\n    const originalView = new Uint8Array(buffer);\n    const newView = new Uint8Array(newBuffer);\n    for (let i = 0; i < originalView.length; i++) {\n      newView[i] = originalView[i];\n    }\n    data = new Uint32Array(newBuffer);\n  } else {\n    data = new Uint32Array(buffer);\n  }\n\n  const originalLengthAsString = originalLength.toString();\n  const resultBuffer = new ArrayBuffer(originalLengthAsString.length + 1 + data.byteLength * 5 / 4);\n  const resultView = new Uint8Array(resultBuffer);\n  let resultIndex = 0;\n  for (let i = 0; i < originalLengthAsString.length; i++) {\n    resultView[resultIndex++] = originalLengthAsString.charCodeAt(i);\n  }\n  resultView[resultIndex++] = 44; // ascii for \",\"\n\n  const getChar = (n) => {\n    n += 0x2a;\n    if (n === 0x3c) return 0x28;\n    if (n === 0x3e) return 0x29;\n    return n;\n  };\n  for (let i = 0; i < data.length; i++) {\n    let n = data[i];\n    resultView[resultIndex++] = getChar(n % 85);\n    n = Math.floor(n / 85);\n    resultView[resultIndex++] = getChar(n % 85);\n    n = Math.floor(n / 85);\n    resultView[resultIndex++] = getChar(n % 85);\n    n = Math.floor(n / 85);\n    resultView[resultIndex++] = getChar(n % 85);\n    n = Math.floor(n / 85);\n    resultView[resultIndex++] = getChar(n % 85);\n  }\n  return new TextDecoder().decode(resultBuffer);\n};\n\n/**\n * @param {string} str\n * @returns {Uint8Array}\n */\nexport const decode = (str) => {\n  const getValue = (code) => {\n    if (code === 0x28) code = 0x3c;\n    if (code === 0x29) code = 0x3e;\n    return code - 0x2a;\n  };\n  const toMultipleOfFour = (n) => {\n    if (n % 4 === 0) {\n      return n;\n    }\n    return n + (4 - n % 4);\n  };\n  const lengthEndsAt = str.indexOf(',');\n  const byteLength = +str.substring(0, lengthEndsAt);\n  const resultBuffer = new ArrayBuffer(toMultipleOfFour(byteLength));\n  const resultView = new Uint32Array(resultBuffer);\n  for (let i = lengthEndsAt + 1, j = 0; i < str.length; i += 5, j++) {\n    resultView[j] = (\n      getValue(str.charCodeAt(i + 4)) * 85 * 85 * 85 * 85 +\n      getValue(str.charCodeAt(i + 3)) * 85 * 85 * 85 +\n      getValue(str.charCodeAt(i + 2)) * 85 * 85 +\n      getValue(str.charCodeAt(i + 1)) * 85 +\n      getValue(str.charCodeAt(i))\n    );\n  }\n  return new Uint8Array(resultBuffer, 0, byteLength);\n};\n","import pickle from 'chromium-pickle-js';\n\nconst generateAsar = (files) => {\n  // https://github.com/electron/asar#format\n\n  const header = {\n    files: {}\n  };\n  let offset = 0;\n  for (const {path, data} of files) {\n    header.files[path] = {\n      offset: offset.toString(),\n      size: data.length\n    };\n    offset += data.length;\n  }\n\n  const headerPickle = pickle.createEmpty();\n  headerPickle.writeString(JSON.stringify(header));\n  const headerBuffer = headerPickle.toBuffer();\n  const sizePickle = pickle.createEmpty();\n  sizePickle.writeUInt32(headerBuffer.length);\n  const sizeBuffer = sizePickle.toBuffer();\n\n  const totalSize = headerBuffer.length + sizeBuffer.length + offset;\n  const result = new Uint8Array(totalSize);\n  let i = 0;\n  result.set(sizeBuffer, i);\n  i += sizeBuffer.length;\n  result.set(headerBuffer, i);\n  i += headerBuffer.length;\n  for (const {data} of files) {\n    result.set(data, i);\n    i += data.length;\n  }\n  return result;\n};\n\nexport default generateAsar;\n","// Parses and generates Apple Info.plist files\n// Example file:\n/*\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n\t<key>BuildMachineOSBuild</key>\n\t<string>20F71</string>\n\t<key>CFBundleDevelopmentRegion</key>\n\t<string>en</string>\n\t<key>CFBundleExecutable</key>\n\t<string>WebView</string>\n\t<key>CFBundleIconFile</key>\n\t<string>AppIcon</string>\n\t<key>CFBundleIconName</key>\n\t<string>AppIcon</string>\n\t<key>CFBundleIdentifier</key>\n\t<string>org.turbowarp.webviews.mac</string>\n\t<key>CFBundleInfoDictionaryVersion</key>\n\t<string>6.0</string>\n\t<key>CFBundleName</key>\n\t<string>WebView</string>\n\t<key>CFBundlePackageType</key>\n\t<string>APPL</string>\n\t<key>CFBundleShortVersionString</key>\n\t<string>1.0</string>\n\t<key>CFBundleSupportedPlatforms</key>\n\t<array>\n\t\t<string>MacOSX</string>\n\t</array>\n\t<key>CFBundleVersion</key>\n\t<string>1</string>\n\t<key>DTCompiler</key>\n\t<string>com.apple.compilers.llvm.clang.1_0</string>\n\t<key>DTPlatformBuild</key>\n\t<string>12E507</string>\n\t<key>DTPlatformName</key>\n\t<string>macosx</string>\n\t<key>DTPlatformVersion</key>\n\t<string>11.3</string>\n\t<key>DTSDKBuild</key>\n\t<string>20E214</string>\n\t<key>DTSDKName</key>\n\t<string>macosx11.3</string>\n\t<key>DTXcode</key>\n\t<string>1251</string>\n\t<key>DTXcodeBuild</key>\n\t<string>12E507</string>\n\t<key>LSApplicationCategoryType</key>\n\t<string>public.app-category.games</string>\n\t<key>LSMinimumSystemVersion</key>\n\t<string>10.12</string>\n\t<key>NSMainStoryboardFile</key>\n\t<string>Main</string>\n\t<key>NSPrincipalClass</key>\n\t<string>NSApplication</string>\n</dict>\n</plist>\n*/\n\nconst xmlToValue = (node) => {\n  if (node.tagName === 'dict') {\n    const result = {};\n    for (const child of node.children) {\n      if (child.tagName === 'key') {\n        result[child.textContent] = xmlToValue(child.nextElementSibling);\n      }\n    }\n    return result;\n  } else if (node.tagName === 'array') {\n    return Array.from(node.children).map(xmlToValue);\n  } else if (node.tagName === 'string') {\n    return node.textContent;\n  }\n  console.warn('unknown plist xml', node);\n  return null;\n};\n\nconst valueToXml = (doc, value) => {\n  if (Array.isArray(value)) {\n    const node = doc.createElement('array');\n    for (const listItem of value) {\n      node.appendChild(valueToXml(doc, listItem));\n    }\n    return node;\n  } else if (typeof value === 'object') {\n    const node = doc.createElement('dict');\n    for (const [key, keyValue] of Object.entries(value)) {\n      const keyNode = doc.createElement('key');\n      keyNode.textContent = key;\n      const valueNode = valueToXml(doc, keyValue);\n      node.appendChild(keyNode);\n      node.appendChild(valueNode);\n    }\n    return node;\n  } else if (typeof value === 'string') {\n    const node = doc.createElement('string');\n    node.textContent = value;\n    return node;\n  }\n  console.warn('unknown plist value', value);\n  return valueToXml(doc, `${value}`);\n};\n\nclass Plist {\n  constructor (string) {\n    const xml = new DOMParser().parseFromString(string, 'text/xml');\n    const rootNode = xml.children[0];\n    const rootDict = rootNode.children[0];\n    this.values = xmlToValue(rootDict);\n  }\n\n  set (key, value) {\n    this.values[key] = value;\n  }\n\n  toString () {\n    const xml = document.implementation.createDocument(null, \"plist\");\n    const rootNode = xml.documentElement;\n    rootNode.setAttribute('version', '1.0');\n    rootNode.appendChild(valueToXml(xml, this.values));\n    const serialized = new XMLSerializer().serializeToString(xml);\n    return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n${serialized}`;\n  }\n}\n\nexport default Plist;\n","import * as Comlink from 'comlink';\nimport EventTarget from '../common/event-target';\nimport ChecksumWorker from 'worker-loader?name=checksum.worker.js!./checksum.worker.js'\nimport defaultIcon from './images/default-icon.png';\nimport {readAsArrayBuffer, readAsURL} from './lib/readers';\nimport largeAssets from './large-assets';\nimport xhr from './lib/xhr';\nimport pngToAppleICNS from './lib/icns';\nimport assetCache from './cache';\nimport {buildId, verifyBuildId} from './lib/build-id';\nimport {encode, decode} from './lib/base85-encode';\nimport generateAsar from './lib/generate-asar';\nimport Plist from './lib/plist';\nimport {APP_NAME, SOURCE_CODE, WEBSITE} from './brand';\n\nconst PROGRESS_LOADED_SCRIPTS = 0.1;\nconst PROGRESS_LOADED_JSON_BUT_NEED_ASSETS = 0.2;\nconst PROGRESS_FETCHED_INLINE_DATA_BUT_NOT_LOADED = 0.9;\nconst PROGRESS_WAITING_FOR_VM_LOAD = 1;\n\nconst escapeXML = (v) => v.replace(/[\"'<>&]/g, (i) => {\n  switch (i) {\n    case '\"': return '&quot;';\n    case '\\'': return '&apos;';\n    case '<': return '&lt;';\n    case '>': return '&gt;';\n    case '&': return '&amp;';\n  }\n});\n\nconst sha256 = async (buffer) => {\n  const worker = new ChecksumWorker();\n  const wrap = Comlink.wrap(worker);\n  const hash = await wrap.sha256(buffer);\n  worker.terminate();\n  return hash;\n};\n\nconst getJSZip = async () => (await import(/* webpackChunkName: \"jszip\" */ 'jszip')).default;\n\nconst setFileFast = (zip, path, data) => {\n  zip.files[path] = data;\n};\n\nconst getAppIcon = async (file) => {\n  if (!file) {\n    return xhr({\n      url: defaultIcon,\n      type: 'arraybuffer'\n    });\n  }\n  // Convert to PNG\n  if (file.type === 'image/png') {\n    return readAsArrayBuffer(file);\n  }\n  return new Promise((resolve, reject) => {\n    const url = URL.createObjectURL(file);\n    const image = new Image();\n    image.onload = () => {\n      image.onload = null;\n      image.onerror = null;\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      if (!ctx) {\n        reject(new Error('Cannot get rendering context for icon conversion'));\n        return;\n      }\n      canvas.width = image.width;\n      canvas.height = image.height;\n      ctx.drawImage(image, 0, 0);\n      canvas.toBlob((blob) => {\n        URL.revokeObjectURL(url);\n        resolve(readAsArrayBuffer(blob));\n      });\n    };\n    image.onerror = () => {\n      image.onload = null;\n      image.onerror = null;\n      reject(new Error('Cannot load icon'));\n    };\n    image.src = url;\n  });\n};\n\nconst SELF_LICENSE = {\n  title: APP_NAME,\n  homepage: WEBSITE,\n  license: `Copyright (C) 2021 Thomas Weber\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU Lesser General Public License version 3\nas published by the Free Software Foundation.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License\nalong with this program. If not, see <https://www.gnu.org/licenses/>.`\n};\n\nconst SCRATCH_LICENSE = {\n  title: 'Scratch',\n  homepage: 'https://scratch.mit.edu/',\n  license: `Copyright (c) 2016, Massachusetts Institute of Technology\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.`\n};\n\nconst ELECTRON_LICENSE = {\n  title: 'Electron',\n  homepage: 'https://www.electronjs.org/',\n  license: `Copyright (c) Electron contributors\nCopyright (c) 2013-2020 GitHub Inc.\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.`\n};\n\nconst COPYRIGHT_HEADER = `/*!\nParts of this script are from the ${APP_NAME} <${SOURCE_CODE}>, licensed as follows:\n${SELF_LICENSE.license}\n\nParts of this script are from Scratch <https://scratch.mit.edu/>, licensed as follows:\n${SCRATCH_LICENSE.license}\n*/\\n`;\n\nconst generateChromiumLicenseHTML = (licenses) => {\n  const pretext = `<h2>The following entries were added by the ${APP_NAME}</h2>`;\n  const convertedLicenses = licenses.map((({title, license, homepage}, index) => `\n<div class=\"product\">\n<span class=\"title\">${escapeXML(title)}</span>\n<span class=\"homepage\"><a href=\"${escapeXML(homepage)}\">homepage</a></span>\n<input type=\"checkbox\" hidden id=\"p4-${index}\">\n<label class=\"show\" for=\"p4-${index}\" tabindex=\"0\"></label>\n<div class=\"licence\">\n<pre>${escapeXML(license)}</pre>\n</div>\n</div>\n`));\n  return `${pretext}${convertedLicenses.join('\\n')}`;\n};\n\nclass Packager extends EventTarget {\n  constructor () {\n    super();\n    this.project = null;\n    this.options = Packager.DEFAULT_OPTIONS();\n  }\n\n  async fetchLargeAsset (name) {\n    const asset = largeAssets[name];\n    if (!asset) {\n      throw new Error(`Invalid asset: ${name}`);\n    }\n    const dispatchProgress = (progress) => this.dispatchEvent(new CustomEvent('large-asset-fetch', {\n      detail: {\n        asset: name,\n        progress\n      }\n    }));\n    dispatchProgress(0);\n    let result;\n    let cameFromCache = false;\n    try {\n      const cached = await assetCache.get(asset);\n      if (cached) {\n        result = cached;\n        cameFromCache = true;\n        dispatchProgress(0.5);\n      }\n    } catch (e) {\n      console.warn(e);\n    }\n    if (!result) {\n      let url = asset.src;\n      if (asset.useBuildId) {\n        url += `?${buildId}`;\n      }\n      result = await xhr({\n        url,\n        type: asset.type,\n        estimatedSize: asset.estimatedSize,\n        progressCallback: (progress) => {\n          dispatchProgress(progress);\n        }\n      });\n    }\n    if (asset.useBuildId && !verifyBuildId(buildId, result)) {\n      throw new Error('Build ID mismatch');\n    }\n    if (asset.sha256) {\n      const hash = await sha256(result);\n      if (hash !== asset.sha256) {\n        throw new Error(`Hash mismatch for ${name}, found ${hash} but expected ${asset.sha256}`);\n      }\n    }\n    if (!cameFromCache) {\n      try {\n        await assetCache.set(asset, result);\n      } catch (e) {\n        console.warn(e);\n      }\n    }\n    dispatchProgress(1);\n    return result;\n  }\n\n  async loadResources () {\n    const texts = [COPYRIGHT_HEADER];\n    if (this.project.analysis.usesMusic) {\n      texts.push(await this.fetchLargeAsset('scaffolding'));\n    } else {\n      texts.push(await this.fetchLargeAsset('scaffolding-min'));\n    }\n    if (this.options.chunks.gamepad || this.options.chunks.pointerlock) {\n      texts.push(await this.fetchLargeAsset('addons'));\n    }\n    this.script = texts.join('\\n').replace(/<\\/script>/g,\"</scri'+'pt>\");\n  }\n\n  async addNwJS (projectZip) {\n    const nwjsBuffer = await this.fetchLargeAsset(this.options.target);\n    const nwjsZip = await (await getJSZip()).loadAsync(nwjsBuffer);\n\n    const isWindows = this.options.target.startsWith('nwjs-win');\n    const isMac = this.options.target === 'nwjs-mac';\n    const isLinux = this.options.target.startsWith('nwjs-linux');\n\n    // NW.js Windows folder structure:\n    // * (root)\n    // +-- nwjs-v0.49.0-win-x64\n    //   +-- nw.exe (executable)\n    //   +-- credits.html\n    //   +-- (project data)\n    //   +-- ...\n\n    // NW.js macOS folder structure:\n    // * (root)\n    // +-- nwjs-v0.49.0-osx-64\n    //   +-- credits.html\n    //   +-- nwjs.app\n    //     +-- Contents\n    //       +-- Resources\n    //         +-- app.icns (icon)\n    //         +-- app.nw\n    //           +-- (project data)\n    //       +-- MacOS\n    //         +-- nwjs (executable)\n    //       +-- ...\n\n    // the first folder, something like \"nwjs-v0.49.0-win-64\"\n    const nwjsPrefix = Object.keys(nwjsZip.files)[0].split('/')[0];\n\n    const zip = new (await getJSZip());\n\n    const packageName = this.options.app.packageName;\n\n    // Copy NW.js files to the right place\n    for (const path of Object.keys(nwjsZip.files)) {\n      const file = nwjsZip.files[path];\n\n      let newPath = path.replace(nwjsPrefix, packageName);\n      if (isWindows) {\n        newPath = newPath.replace('nw.exe', `${packageName}.exe`);\n      } else if (isMac) {\n        newPath = newPath.replace('nwjs.app', `${packageName}.app`);\n      } else if (isLinux) {\n        newPath = newPath.replace(/nw$/, packageName);\n      }\n\n      setFileFast(zip, newPath, file);\n    }\n\n    const ICON_NAME = 'icon.png';\n    const icon = await getAppIcon(this.options.app.icon);\n    const manifest = {\n      name: packageName,\n      main: 'main.js',\n      window: {\n        width: this.options.stageWidth,\n        height: this.options.stageHeight,\n        icon: ICON_NAME\n      }\n    };\n\n    let dataPrefix;\n    if (isWindows) {\n      dataPrefix = `${packageName}/`;\n    } else if (isMac) {\n      const icnsData = await pngToAppleICNS(icon);\n      zip.file(`${packageName}/${packageName}.app/Contents/Resources/app.icns`, icnsData);\n      dataPrefix = `${packageName}/${packageName}.app/Contents/Resources/app.nw/`;\n    } else if (isLinux) {\n      const startScript = `#!/bin/bash\ncd \"$(dirname \"$0\")\"\n./${packageName}`;\n      zip.file(`${packageName}/start.sh`, startScript, {\n        unixPermissions: 0o100755\n      });\n      dataPrefix = `${packageName}/`;\n    }\n\n    // Copy project files and extra NW.js files to the right place\n    for (const path of Object.keys(projectZip.files)) {\n      setFileFast(zip, dataPrefix + path, projectZip.files[path]);\n    }\n    zip.file(dataPrefix + ICON_NAME, icon);\n    zip.file(dataPrefix + 'package.json', JSON.stringify(manifest, null, 4));\n    zip.file(dataPrefix + 'main.js', `\n    const start = () => nw.Window.open('index.html', {\n      position: \"center\",\n      new_instance: true\n    });\n    nw.App.on('open', start);\n    start();`);\n\n    const creditsHtmlPath = `${packageName}/credits.html`;\n    const creditsHtml = await zip.file(creditsHtmlPath).async('string');\n    zip.file(creditsHtmlPath, creditsHtml + generateChromiumLicenseHTML([\n      SELF_LICENSE,\n      SCRATCH_LICENSE\n    ]));\n\n    return zip;\n  }\n\n  async addElectron (projectZip) {\n    const buffer = await this.fetchLargeAsset(this.options.target);\n    const electronZip = await (await getJSZip()).loadAsync(buffer);\n\n    const isWindows = this.options.target.includes('win');\n    const isMac = this.options.target.includes('mac');\n    const isLinux = this.options.target.includes('linux');\n\n    // Electron Windows/Linux folder structure:\n    // * (root)\n    // +-- electron.exe (executable)\n    // +-- LICENSES.chromium.html\n    // +-- ...\n\n    const zip = new (await getJSZip());\n    const packageName = this.options.app.packageName;\n    for (const path of Object.keys(electronZip.files)) {\n      const file = electronZip.files[path];\n      // Create an inner folder inside the zip\n      let newPath = `${packageName}/${path}`;\n      // Rename the executable file\n      if (isWindows) {\n        newPath = newPath.replace('electron.exe', `${packageName}.exe`);\n      } else if (isMac) {\n        // TODO\n      } else if (isLinux) {\n        newPath = newPath.replace(/electron$/, packageName);\n      }\n      setFileFast(zip, newPath, file);\n    }\n\n    const ICON_NAME = 'icon.png';\n    const icon = await getAppIcon(this.options.app.icon);\n    const manifest = {\n      name: packageName,\n      main: 'main.js'\n    };\n\n    let dataPrefix;\n    if (isWindows) {\n      dataPrefix = `${packageName}/`;\n    } else if (isMac) {\n      // TODO\n    } else if (isLinux) {\n      const startScript = `#!/bin/bash\ncd \"$(dirname \"$0\")\"\n./${packageName}`;\n      zip.file(`${packageName}/start.sh`, startScript, {\n        unixPermissions: 0o100755\n      });\n      dataPrefix = `${packageName}/`;\n    }\n    for (const path of Object.keys(projectZip.files)) {\n      setFileFast(zip, dataPrefix + path, projectZip.files[path]);\n    }\n\n    const creditsHtml = await zip.file(`${packageName}/LICENSES.chromium.html`).async('string');\n    zip.remove(`${packageName}/LICENSE.txt`);\n    zip.remove(`${packageName}/LICENSES.chromium.html`);\n    zip.file(`${packageName}/licenses.html`, creditsHtml + generateChromiumLicenseHTML([\n      SELF_LICENSE,\n      SCRATCH_LICENSE,\n      ELECTRON_LICENSE\n    ]));\n\n    zip.file(`${dataPrefix}${ICON_NAME}`, icon);\n    zip.file(`${dataPrefix}resources/default_app.asar`, generateAsar([\n      {\n        path: 'package.json',\n        data: new TextEncoder().encode(JSON.stringify(manifest))\n      },\n      {\n        path: 'main.js',\n        data: new TextEncoder().encode('require(\"../../main.js\")')\n      }\n    ]));\n    zip.file(`${dataPrefix}package.json`, JSON.stringify(manifest));\n    zip.file(`${dataPrefix}main.js`, `'use strict';\nconst {app, BrowserWindow, Menu, shell, screen} = require('electron');\nconst path = require('path');\n\nconst isWindows = process.platform === 'win32';\nconst isMac = process.platform === 'darwin';\nconst isLinux = process.platform === 'linux';\n\nif (isMac) {\n  // TODO\n  Menu.setApplicationMenu(Menu.buildFromTemplate([\n    { role: 'appMenu' },\n    { role: 'fileMenu' },\n    { role: 'editMenu' },\n    { role: 'viewMenu' },\n    { role: 'windowMenu' },\n    { role: 'help' }\n  ]));\n} else {\n  Menu.setApplicationMenu(null);\n}\n\nconst isSafeOpenExternal = (url) => {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol === 'https:' || parsedUrl.protocol === 'http:';\n  } catch (e) {\n    // ignore\n  }\n  return false;\n};\n\nconst createWindow = () => {\n  const options = {\n    width: ${this.options.stageWidth},\n    height: ${this.options.stageHeight},\n    useContentSize: true,\n    minWidth: 50,\n    minHeight: 50,\n    icon: path.resolve('${ICON_NAME}'),\n    webPreferences: {\n      contextIsolation: true,\n      nodeIntegration: false,\n      sandbox: true\n    },\n    show: false,\n    backgroundColor: ${JSON.stringify(this.options.appearance.background)}\n  };\n\n  const activeScreen = screen.getDisplayNearestPoint(screen.getCursorScreenPoint());\n  const bounds = activeScreen.workArea;\n  options.x = bounds.x + ((bounds.width - options.width) / 2);\n  options.y = bounds.y + ((bounds.height - options.height) / 2);\n\n  const window = new BrowserWindow(options);\n  window.once('ready-to-show', () => {\n    window.show();\n  });\n  window.loadFile('../../index.html');\n};\n\nconst acquiredLock = app.requestSingleInstanceLock();\nif (acquiredLock) {\n  app.enableSandbox();\n\n  app.on('web-contents-created', (event, contents) => {\n    // TODO: new-window is deprecated\n    contents.on('new-window', (e, url) => {\n      e.preventDefault();\n      if (isSafeOpenExternal(url)) {\n        shell.openExternal(url);\n      }\n    });\n    contents.on('will-navigate', (e, url) => {\n      e.preventDefault();\n      if (isSafeOpenExternal(url)) {\n        shell.openExternal(url);\n      }\n    });\n  });\n\n  app.on('window-all-closed', () => {\n    app.quit();\n  });\n\n  app.on('second-instance', () => {\n    createWindow();\n  });\n\n  app.whenReady().then(() => {\n    createWindow();\n    app.on('activate', () => {\n      if (BrowserWindow.getAllWindows().length === 0) createWindow();\n    });\n  });\n} else {\n  app.quit();\n}\n`);\n\n    return zip;\n  }\n\n  async addWebViewMac (projectZip) {\n    const buffer = await this.fetchLargeAsset(this.options.target);\n    const appZip = await (await getJSZip()).loadAsync(buffer);\n\n    // +-- WebView.app\n    //   +-- Contents\n    //     +-- Info.plist\n    //     +-- MacOS\n    //       +-- WebView (executable)\n    //     +-- Resources\n    //       +-- index.html\n    //       +-- application_config.json\n    //       +-- AppIcon.icns\n\n    const newAppName = `${this.options.app.packageName}.app`;\n    const contentsPrefix = `${newAppName}/Contents/`;\n    const resourcePrefix = `${newAppName}/Contents/Resources/`;\n\n    const zip = new (await getJSZip());\n    for (const [path, data] of Object.entries(appZip.files)) {\n      const newPath = path\n        // Rename the .app itself\n        .replace('WebView.app', newAppName)\n        // Rename the executable\n        .replace(/WebView$/, this.options.app.packageName);\n      setFileFast(zip, newPath, data);\n    }\n    for (const [path, data] of Object.entries(projectZip.files)) {\n      setFileFast(zip, `${resourcePrefix}${path}`, data);\n    }\n\n    const icon = await getAppIcon(this.options.app.icon);\n    const icns = await pngToAppleICNS(icon);\n    zip.file(`${resourcePrefix}AppIcon.icns`, icns);\n    zip.remove(`${resourcePrefix}Assets.car`);\n\n    const parsedBackgroundColor = parseInt(this.options.appearance.background.substr(1), 16);\n    const applicationConfig = {\n      title: this.options.app.windowTitle,\n      background: [\n        // R, G, B [0-255]\n        parsedBackgroundColor >> 16 & 0xff,\n        parsedBackgroundColor >> 8 & 0xff,\n        parsedBackgroundColor & 0xff,\n        // A [0-1]\n        1\n      ],\n      width: this.options.stageWidth,\n      height: this.options.stageHeight\n    };\n    zip.file(`${resourcePrefix}application_config.json`, JSON.stringify(applicationConfig));\n\n    const plist = new Plist(await zip.file(`${contentsPrefix}Info.plist`).async('string'));\n    // If CFBundleIdentifier changes, then things like saved local cloud variables will be reset.\n    plist.set('CFBundleIdentifier', `org.turbowarp.packager.userland.${this.options.app.packageName}`);\n    plist.set('CFBundleName', this.options.app.windowTitle);\n    plist.set('CFBundleExecutable', this.options.app.packageName);\n    // TODO: update LSApplicationCategoryType\n    zip.file(`${contentsPrefix}Info.plist`, plist.toString());\n\n    return zip;\n  }\n\n  makeWebSocketProvider () {\n    return `new Scaffolding.Cloud.WebSocketProvider(${JSON.stringify(this.options.cloudVariables.cloudHost)}, ${JSON.stringify(this.options.projectId)})`;\n  }\n\n  makeLocalStorageProvider () {\n    return `new Scaffolding.Cloud.LocalStorageProvider(${JSON.stringify(`cloudvariables:${this.options.projectId}`)})`;\n  }\n\n  makeCustomProvider () {\n    const variables = this.options.cloudVariables.custom;\n    let result = '{const providers = {};\\n';\n    for (const provider of new Set(Object.values(variables))) {\n      if (provider === 'ws') {\n        result += `providers.ws = ${this.makeWebSocketProvider()};\\n`;\n      } else if (provider === 'local') {\n        result += `providers.local = ${this.makeLocalStorageProvider()};\\n`;\n      }\n    }\n    result += 'for (const provider of Object.values(providers)) scaffolding.addCloudProvider(provider);\\n';\n    for (const variableName of Object.keys(variables)) {\n      const providerToUse = variables[variableName];\n      result += `scaffolding.addCloudProviderOverride(${JSON.stringify(variableName)}, providers[${JSON.stringify(providerToUse)}] || null);\\n`;\n    }\n    result += '}';\n    return result;\n  }\n\n  generateFilename (extension) {\n    return `${this.options.app.windowTitle}.${extension}`;\n  }\n\n  async generateGetProjectData () {\n    if (this.options.target === 'html') {\n      const data = await readAsArrayBuffer(this.project.blob);\n      const base85 = encode(data);\n      return `<script id=\"p4-encoded-project-data\" type=\"p4-encoded-project-data\">${base85}</script>\n  <script>\n    setProgress(${PROGRESS_FETCHED_INLINE_DATA_BUT_NOT_LOADED});\n    const base85decode = ${decode.toString()};\n    const getProjectData = async () => {\n      const dataElement = document.getElementById(\"p4-encoded-project-data\");\n      const result = base85decode(dataElement.textContent);\n      dataElement.remove();\n      setProgress(${PROGRESS_WAITING_FOR_VM_LOAD});\n      return result;\n    };\n  </script>`\n    }\n    let src;\n    let progressWeight;\n    if (this.project.type === 'blob' || this.options.target === 'zip-one-asset') {\n      src = './project.zip';\n      progressWeight = PROGRESS_WAITING_FOR_VM_LOAD - PROGRESS_LOADED_SCRIPTS;\n    } else {\n      src = './assets/project.json';\n      progressWeight = PROGRESS_LOADED_JSON_BUT_NEED_ASSETS - PROGRESS_LOADED_SCRIPTS;\n    }\n    return `<script>\n    const getProjectData = () => new Promise((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.onload = () => {\n        resolve(xhr.response);\n      };\n      xhr.onerror = () => {\n        if (location.protocol === 'file:') {\n          reject(new Error(\"Zip environment must be used from a website, not from a file URL.\"));\n        } else {\n          reject(new Error(\"Request to load project data failed.\"));\n        }\n      };\n      xhr.onprogress = (e) => {\n        if (e.lengthComputable) {\n          setProgress(${PROGRESS_LOADED_SCRIPTS} + (e.loaded / e.total) * ${progressWeight});\n        }\n      };\n      xhr.responseType = \"arraybuffer\";\n      xhr.open(\"GET\", ${JSON.stringify(src)});\n      xhr.send();\n    });\n  </script>`;\n  }\n\n  async generateFavicon () {\n    if (this.options.app.icon === null) {\n      return '<!-- no favicon -->';\n    }\n    const data = await readAsURL(this.options.app.icon);\n    return `<link rel=\"icon\" href=\"${data}\">`;\n  }\n\n  async generateCursor () {\n    if (this.options.cursor.type !== 'custom') {\n      return this.options.cursor.type;\n    }\n    if (!this.options.cursor.custom) {\n      // Set to custom but no data, so ignore\n      return 'auto';\n    }\n    const data = await readAsURL(this.options.cursor.custom);\n    return `url(${data}), auto`;\n  }\n\n  async package () {\n    await this.loadResources();\n    const html = `<!DOCTYPE html>\n<!-- Created with ${WEBSITE} -->\n<html>\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n  <!-- We only include this to explicitly loosen the CSP of various packager environments. It does not provide any security. -->\n  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob:\">\n  <title>${escapeXML(this.options.app.windowTitle)}</title>\n  <style>\n    body {\n      color: ${this.options.appearance.foreground};\n      font-family: sans-serif;\n      overflow: hidden;\n      margin: 0;\n      padding: 0;\n    }\n    :root, body.is-fullscreen {\n      background-color: ${this.options.appearance.background};\n    }\n    [hidden] {\n      display: none !important;\n    }\n    h1 {\n      font-weight: normal;\n    }\n    a {\n      color: inherit;\n      text-decoration: underline;\n      cursor: pointer;\n    }\n\n    #app, #loading, #error, #launch {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    .screen {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      text-align: center;\n      cursor: default;\n      user-select: none;\n      -webkit-user-select: none;\n      background-color: ${this.options.appearance.background};\n    }\n    #launch {\n      background-color: rgba(0, 0, 0, 0.7);\n      cursor: pointer;\n    }\n    .green-flag {\n      width: 80px;\n      height: 80px;\n      padding: 16px;\n      border-radius: 100%;\n      background: rgba(255, 255, 255, 0.75);\n      border: 3px solid hsla(0, 100%, 100%, 1);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      box-sizing: border-box;\n    }\n    #loading {\n      ${this.options.loadingScreen.image && this.options.loadingScreen.imageMode === 'stretch'\n        ? `background-image: url(${await readAsURL(this.options.loadingScreen.image)});\n      background-repeat: no-repeat;\n      background-size: contain;\n      background-position: center;`\n        : ''}\n    }\n    .progress-bar-outer {\n      border: 1px solid currentColor;\n      height: 10px;\n      width: 200px;\n      max-width: 200px;\n    }\n    .progress-bar-inner {\n      height: 100%;\n      width: 0;\n      background-color: currentColor;\n    }\n    .loading-text {\n      font-weight: normal;\n      font-size: 36px;\n      margin: 0 0 16px;\n    }\n    .loading-image {\n      margin: 0 0 16px;\n    }\n    #error-info {\n      font-family: monospace;\n    }\n    .control-button {\n      width: 2rem;\n      height: 2rem;\n      padding: 0.375rem;\n      border-radius: 0.25rem;\n      margin-top: 0.5rem;\n      margin-bottom: 0.5rem;\n      user-select: none;\n      -webkit-user-select: none;\n      cursor: pointer;\n      border: 0;\n      border-radius: 4px;\n    }\n    .control-button:hover {\n      background: ${this.options.appearance.accent}26;\n    }\n    .control-button.active {\n      background: ${this.options.appearance.accent}59;\n    }\n    .fullscreen-button {\n      background: white !important;\n    }\n    .standalone-fullscreen-button {\n      position: absolute;\n      top: 0;\n      right: 0;\n      background-color: rgba(0, 0, 0, 0.5);\n      border-radius: 0 0 0 4px;\n      padding: 4px;\n      cursor: pointer;\n    }\n    .sc-canvas {\n      cursor: ${await this.generateCursor()};\n    }\n  </style>\n  <meta name=\"theme-color\" content=\"${this.options.appearance.background}\">\n  ${await this.generateFavicon()}\n</head>\n<body>\n  <noscript>Enable JavaScript</noscript>\n\n  <div id=\"app\"></div>\n\n  <div id=\"launch\" class=\"screen\" hidden title=\"Click to start\">\n    <div class=\"green-flag\">\n      <svg viewBox=\"0 0 16.63 17.5\" width=\"42\" height=\"44\">\n        <defs><style>.cls-1,.cls-2{fill:#4cbf56;stroke:#45993d;stroke-linecap:round;stroke-linejoin:round;}.cls-2{stroke-width:1.5px;}</style></defs>\n        <path class=\"cls-1\" d=\"M.75,2A6.44,6.44,0,0,1,8.44,2h0a6.44,6.44,0,0,0,7.69,0V12.4a6.44,6.44,0,0,1-7.69,0h0a6.44,6.44,0,0,0-7.69,0\"/>\n        <line class=\"cls-2\" x1=\"0.75\" y1=\"16.75\" x2=\"0.75\" y2=\"0.75\"/>\n      </svg>\n    </div>\n  </div>\n\n  <div id=\"loading\" class=\"screen\">\n    ${this.options.loadingScreen.text ? `<h1 class=\"loading-text\">${escapeXML(this.options.loadingScreen.text)}</h1>` : ''}\n    ${this.options.loadingScreen.image && this.options.loadingScreen.imageMode === 'normal' ? `<div class=\"loading-image\"><img src=\"${await readAsURL(this.options.loadingScreen.image)}\"></div>` : ''}\n    ${this.options.loadingScreen.progressBar ? '<div class=\"progress-bar-outer\"><div class=\"progress-bar-inner\" id=\"loading-inner\"></div></div>' : ''}\n  </div>\n\n  <div id=\"error\" class=\"screen\" hidden>\n    <h1>Error</h1>\n    <p>Something went wrong.</p>\n    <p id=\"error-info\"></p>\n  </div>\n\n  ${this.options.target === 'html' ? `<script>${this.script}</script>` : '<script src=\"script.js\"></script>'}\n  <script>\n    const appElement = document.getElementById('app');\n    const launchScreen = document.getElementById('launch');\n    const loadingScreen = document.getElementById('loading');\n    const loadingInner = document.getElementById('loading-inner');\n    const errorScreen = document.getElementById('error');\n    const errorScreenInfo = document.getElementById('error-info');\n\n    const handleError = (error) => {\n      console.error(error);\n      if (!errorScreen.hidden) return;\n      errorScreen.hidden = false;\n      errorScreenInfo.textContent = '' + error;\n    };\n    const setProgress = (progress) => {\n      if (loadingInner) loadingInner.style.width = progress * 100 + \"%\";\n    };\n\n    try {\n      const scaffolding = new Scaffolding.Scaffolding();\n      scaffolding.width = ${this.options.stageWidth};\n      scaffolding.height = ${this.options.stageHeight};\n      scaffolding.setup();\n      scaffolding.appendTo(appElement);\n\n      if (typeof ScaffoldingAddons !== \"undefined\") {\n        ScaffoldingAddons.run(scaffolding, ${JSON.stringify(this.options.chunks)});\n      }\n\n      // Expose values expected by third-party plugins\n      window.scaffolding = scaffolding;\n      window.vm = scaffolding.vm;\n\n      const {storage, vm} = scaffolding;\n      storage.addWebStore(\n        [storage.AssetType.ImageVector, storage.AssetType.ImageBitmap, storage.AssetType.Sound],\n        (asset) => new URL(\"./assets/\" + asset.assetId + \".\" + asset.dataFormat, location).href\n      );\n      storage.onprogress = (total, loaded) => {\n        setProgress(${PROGRESS_LOADED_JSON_BUT_NEED_ASSETS} + (loaded / total) * ${1 - PROGRESS_LOADED_JSON_BUT_NEED_ASSETS});\n      };\n      setProgress(${PROGRESS_LOADED_SCRIPTS});\n\n      scaffolding.setUsername(${JSON.stringify(this.options.username)}.replace(/#/g, () => Math.floor(Math.random() * 10)));\n      scaffolding.setAccentColor(${JSON.stringify(this.options.appearance.accent)});\n\n      ${this.options.cloudVariables.mode === 'ws' ?\n        `scaffolding.addCloudProvider(${this.makeWebSocketProvider()})` :\n        this.options.cloudVariables.mode === 'local' ?\n        `scaffolding.addCloudProvider(${this.makeLocalStorageProvider()})` :\n        this.options.cloudVariables.mode === 'custom' ?\n        this.makeCustomProvider() :\n        '/* no-op */'\n      };\n\n      if (${this.options.controls.greenFlag.enabled}) {\n        const greenFlagButton = document.createElement(\"img\");\n        greenFlagButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16.63 17.5\"><path d=\"M.75 2a6.44 6.44 0 017.69 0h0a6.44 6.44 0 007.69 0v10.4a6.44 6.44 0 01-7.69 0h0a6.44 6.44 0 00-7.69 0\" fill=\"#4cbf56\" stroke=\"#45993d\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path stroke-width=\"1.5\" fill=\"#4cbf56\" stroke=\"#45993d\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M.75 16.75v-16\"/></svg>');\n        greenFlagButton.className = 'control-button';\n        greenFlagButton.addEventListener('click', () => {\n          scaffolding.greenFlag();\n        });\n        scaffolding.addEventListener('PROJECT_RUN_START', () => {\n          greenFlagButton.classList.add('active');\n        });\n        scaffolding.addEventListener('PROJECT_RUN_STOP', () => {\n          greenFlagButton.classList.remove('active');\n        });\n        scaffolding.addControlButton({\n          element: greenFlagButton,\n          where: 'top-left'\n        });\n      }\n\n      if (${this.options.controls.stopAll.enabled}) {\n        const stopAllButton = document.createElement(\"img\");\n        stopAllButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 14\"><path fill=\"#ec5959\" stroke=\"#b84848\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" d=\"M4.3.5h5.4l3.8 3.8v5.4l-3.8 3.8H4.3L.5 9.7V4.3z\"/></svg>');\n        stopAllButton.className = 'control-button';\n        stopAllButton.addEventListener('click', () => {\n          scaffolding.stopAll();\n        });\n        scaffolding.addControlButton({\n          element: stopAllButton,\n          where: 'top-left'\n        });\n      }\n\n      if (${this.options.controls.fullscreen.enabled} && (document.fullscreenEnabled || document.webkitFullscreenEnabled)) {\n        let isFullScreen = !!(document.fullscreenElement || document.webkitFullscreenElement);\n        const fullscreenButton = document.createElement('img');\n        fullscreenButton.className = 'control-button fullscreen-button';\n        fullscreenButton.addEventListener('click', () => {\n          if (isFullScreen) {\n            if (document.exitFullscreen) {\n              document.exitFullscreen();\n            } else if (document.webkitExitFullscreen) {\n              document.webkitExitFullscreen();\n            }\n          } else {\n            if (document.body.requestFullscreen) {\n              document.body.requestFullscreen()\n            } else if (document.body.webkitRequestFullscreen) {\n              document.body.webkitRequestFullscreen();\n            }\n          }\n        });\n        const otherControlsExist = ${this.options.controls.greenFlag.enabled || this.options.controls.stopAll.enabled};\n        const fillColor = otherControlsExist ? '#575E75' : '${this.options.appearance.foreground}';\n        const updateFullScreen = () => {\n          isFullScreen = !!(document.fullscreenElement || document.webkitFullscreenElement);\n          document.body.classList.toggle(\"is-fullscreen\", isFullScreen);\n          if (isFullScreen) {\n            fullscreenButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg width=\"20\" height=\"20\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"' + fillColor + '\" fill-rule=\"evenodd\"><path d=\"M12.662 3.65l.89.891 3.133-2.374a.815.815 0 011.15.165.819.819 0 010 .986L15.467 6.46l.867.871c.25.25.072.664-.269.664L12.388 8A.397.397 0 0112 7.611V3.92c0-.341.418-.514.662-.27M7.338 16.35l-.89-.89-3.133 2.374a.817.817 0 01-1.15-.166.819.819 0 010-.985l2.37-3.143-.87-.871a.387.387 0 01.27-.664L7.612 12a.397.397 0 01.388.389v3.692a.387.387 0 01-.662.27M7.338 3.65l-.89.891-3.133-2.374a.815.815 0 00-1.15.165.819.819 0 000 .986l2.37 3.142-.87.871a.387.387 0 00.27.664L7.612 8A.397.397 0 008 7.611V3.92a.387.387 0 00-.662-.27M12.662 16.35l.89-.89 3.133 2.374a.817.817 0 001.15-.166.819.819 0 000-.985l-2.368-3.143.867-.871a.387.387 0 00-.269-.664L12.388 12a.397.397 0 00-.388.389v3.692c0 .342.418.514.662.27\"/></g></svg>');\n          } else {\n            fullscreenButton.src = 'data:image/svg+xml,' + encodeURIComponent('<svg width=\"20\" height=\"20\" xmlns=\"http://www.w3.org/2000/svg\"><g fill=\"' + fillColor + '\" fill-rule=\"evenodd\"><path d=\"M16.338 7.35l-.89-.891-3.133 2.374a.815.815 0 01-1.15-.165.819.819 0 010-.986l2.368-3.142-.867-.871a.387.387 0 01.269-.664L16.612 3a.397.397 0 01.388.389V7.08a.387.387 0 01-.662.27M3.662 12.65l.89.89 3.133-2.374a.817.817 0 011.15.166.819.819 0 010 .985l-2.37 3.143.87.871c.248.25.071.664-.27.664L3.388 17A.397.397 0 013 16.611V12.92c0-.342.418-.514.662-.27M3.662 7.35l.89-.891 3.133 2.374a.815.815 0 001.15-.165.819.819 0 000-.986L6.465 4.54l.87-.871a.387.387 0 00-.27-.664L3.388 3A.397.397 0 003 3.389V7.08c0 .341.418.514.662.27M16.338 12.65l-.89.89-3.133-2.374a.817.817 0 00-1.15.166.819.819 0 000 .985l2.368 3.143-.867.871a.387.387 0 00.269.664l3.677.005a.397.397 0 00.388-.389V12.92a.387.387 0 00-.662-.27\"/></g></svg>');\n          }\n        };\n        updateFullScreen();\n        document.addEventListener('fullscreenchange', updateFullScreen);\n        document.addEventListener('webkitfullscreenchange', updateFullScreen);\n        if (otherControlsExist) {\n          fullscreenButton.className = 'control-button fullscreen-button';\n          scaffolding.addControlButton({\n            element: fullscreenButton,\n            where: 'top-right'\n          });\n        } else {\n          fullscreenButton.className = 'standalone-fullscreen-button';\n          document.body.appendChild(fullscreenButton);\n        }\n      }\n\n      vm.setTurboMode(${this.options.turbo});\n      if (vm.setInterpolation) vm.setInterpolation(${this.options.interpolation});\n      if (vm.setFramerate) vm.setFramerate(${this.options.framerate});\n      if (vm.renderer.setUseHighQualityRender) vm.renderer.setUseHighQualityRender(${this.options.highQualityPen});\n      if (vm.setRuntimeOptions) vm.setRuntimeOptions({\n        fencing: ${this.options.fencing},\n        miscLimits: ${this.options.miscLimits},\n        maxClones: ${this.options.maxClones},\n      });\n      if (vm.setCompilerOptions) vm.setCompilerOptions({\n        enabled: ${this.options.compiler.enabled},\n        warpTimer: ${this.options.compiler.warpTimer}\n      });\n\n      for (const extension of ${JSON.stringify(this.options.extensions.map(i => i.url))}) {\n        vm.extensionManager.loadExtensionURL(extension);\n      }\n    } catch (e) {\n      handleError(e);\n    }\n\n    // NW.js hook\n    if (typeof nw !== 'undefined') {\n      const win = nw.Window.get();\n      win.on('new-win-policy', (frame, url, policy) => {\n        policy.ignore();\n        nw.Shell.openExternal(url);\n      });\n      win.on('navigation', (frame, url, policy) => {\n        policy.ignore();\n        nw.Shell.openExternal(url);\n      });\n      document.addEventListener(\"keydown\", (e) => {\n        if (e.key === \"Escape\" && document.fullscreenElement) {\n          document.exitFullscreen();\n        }\n      });\n    }\n    ${this.options.custom.js}\n  </script>\n  ${await this.generateGetProjectData()}\n  <script>\n    const run = async () => {\n      const projectData = await getProjectData();\n      await scaffolding.loadProject(projectData);\n      setProgress(1);\n      loadingScreen.hidden = true;\n      if (${this.options.autoplay}) {\n        scaffolding.start();\n      } else {\n        launchScreen.hidden = false;\n        launchScreen.addEventListener('click', () => {\n          launchScreen.hidden = true;\n          scaffolding.start();\n        });\n        launchScreen.focus();\n      }\n    };\n    run().catch(handleError);\n  </script>\n</body>\n</html>\n`;\n\n    if (this.options.target !== 'html') {\n      let zip;\n      if (this.project.type === 'sb3' && this.options.target !== 'zip-one-asset') {\n        zip = await (await getJSZip()).loadAsync(this.project.blob);\n        for (const file of Object.keys(zip.files)) {\n          zip.files[`assets/${file}`] = zip.files[file];\n          delete zip.files[file];\n        }\n      } else {\n        zip = new (await getJSZip());\n        zip.file('project.zip', this.project.blob);\n      }\n      zip.file('index.html', html);\n      zip.file('script.js', this.script);\n\n      if (this.options.target.startsWith('nwjs-')) {\n        zip = await this.addNwJS(zip);\n      } else if (this.options.target.startsWith('electron-')) {\n        zip = await this.addElectron(zip);\n      } else if (this.options.target === 'webview-mac') {\n        zip = await this.addWebViewMac(zip);\n      }\n\n      return {\n        blob: await zip.generateAsync({\n          type: 'blob',\n          compression: 'DEFLATE',\n          // Use UNIX permissions so that executable bits are properly set for macOS and Linux\n          platform: 'UNIX'\n        }, (meta) => {\n          this.dispatchEvent(new CustomEvent('zip-progress', {\n            detail: {\n              progress: meta.percent / 100\n            }\n          }));\n        }),\n        filename: this.generateFilename('zip')\n      };\n    }\n    return {\n      blob: new Blob([html], {\n        type: 'text/html'\n      }),\n      filename: this.generateFilename('html')\n    };\n  }\n}\n\nPackager.getDefaultPackageNameFromFileName = (title) => {\n  // Remove file extension\n  title = title.split('.')[0];\n  title = title.replace(/[^\\-a-z ]/gi, '');\n  title = title.trim();\n  title = title.replace(/ /g, '-');\n  return title.toLowerCase() || 'packaged-project';\n};\n\nPackager.getWindowTitleFromFileName = (title) => {\n  title = title.trim();\n  title = title.split('.')[0];\n  return title || 'Packaged Project';\n};\n\nPackager.DEFAULT_OPTIONS = () => ({\n  turbo: false,\n  interpolation: false,\n  framerate: 30,\n  highQualityPen: false,\n  maxClones: 300,\n  fencing: true,\n  miscLimits: true,\n  stageWidth: 480,\n  stageHeight: 360,\n  autoplay: false,\n  username: 'player####',\n  custom: {\n    js: ''\n  },\n  appearance: {\n    background: '#000000',\n    foreground: '#ffffff',\n    accent: '#ff4c4c'\n  },\n  loadingScreen: {\n    progressBar: true,\n    text: '',\n    imageMode: 'normal',\n    image: null\n  },\n  controls: {\n    greenFlag: {\n      enabled: false,\n    },\n    stopAll: {\n      enabled: false,\n    },\n    fullscreen: {\n      enabled: false\n    }\n  },\n  compiler: {\n    enabled: true,\n    warpTimer: false\n  },\n  target: 'html',\n  app: {\n    icon: null,\n    packageName: Packager.getDefaultPackageNameFromFileName(''),\n    windowTitle: Packager.getWindowTitleFromFileName('')\n  },\n  chunks: {\n    gamepad: false,\n    pointerlock: false\n  },\n  cloudVariables: {\n    mode: 'ws',\n    id: 0,\n    cloudHost: 'wss://clouddata.turbowarp.org',\n    custom: {}\n  },\n  cursor: {\n    type: 'auto',\n    custom: null\n  },\n  extensions: []\n});\n\nexport default Packager;\n","import {writable} from 'svelte/store';\nimport Database from './lib/idb';\nimport {readAsArrayBuffer} from './lib/readers';\n\nconst DATABASE_NAME = 'p4-local-settings';\nconst DATABASE_VERSION = 1;\nconst STORE_NAME = 'blobs';\n\nconst db = new Database(DATABASE_NAME, DATABASE_VERSION, STORE_NAME);\n\nconst makeNamedBlob = (buffer, type, name) => {\n  const blob = new Blob([buffer], {type});\n  blob.name = name;\n  return blob;\n};\n\nconst cloneBlob = async (blob) => {\n  const buffer = await readAsArrayBuffer(blob);\n  return makeNamedBlob(buffer, blob.type, blob.name);\n};\n\nconst get = async (key) => {\n  const {transaction, store} = await db.createTransaction('readonly');\n  return new Promise((resolve, reject) => {\n    Database.setTransactionErrorHandler(transaction, reject);\n    const request = store.get(key);\n    request.onsuccess = (e) => {\n      const result = e.target.result;\n      if (result) {\n        const data = result.data;\n        // Older versions stored these files as instances of File\n        if (data instanceof Blob) {\n          // Clone immediately to fix spurious \"NotFoundError: Node was not found\" in Firefox\n          resolve(cloneBlob(data));\n        } else {\n          resolve(makeNamedBlob(data, result.type, result.name));\n        }\n      } else {\n        resolve(null);\n      }\n    };\n  });\n};\n\nconst set = async (key, file) => {\n  const arrayBuffer = file ? await readAsArrayBuffer(file) : null;\n  const {transaction, store} = await db.createTransaction('readwrite');\n  return new Promise((resolve, reject) => {\n    Database.setTransactionErrorHandler(transaction, reject);\n    const request = file ? store.put({\n      id: key,\n      data: arrayBuffer,\n      type: file.type,\n      name: file.name\n    }) : store.delete(key);\n    request.onsuccess = () => {\n      resolve();\n    };\n  });\n};\n\nconst resetAll = () => db.deleteEverything();\n\nconst writableFileStore = (key) => {\n  let hasQueried = false;\n  const store = writable(null, () => {\n    const unsubscribe = store.subscribe((file) => {\n      if (hasQueried) {\n        set(key, file)\n          .catch((err) => {\n            console.warn(err);\n          });\n      }\n    });\n    return unsubscribe;\n  });\n  get(key)\n    .then((value) => {\n      hasQueried = true;\n      if (value) {\n        store.set(value);\n      }\n    });\n  return store;\n};\n\nexport default {\n  writableFileStore,\n  resetAll\n};\n","const source = `<!DOCTYPE html>\n<html>\n<head>\n  <title>Loading Preview</title>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n  <style>\n  body {\n    background: black;\n    color: white;\n    font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n  }\n  .preview-message {\n    background: inherit;\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n    justify-content: center;\n    text-align: center;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    user-select: none;\n    -webkit-user-select: none;\n  }\n  .preview-progress-outer {\n    width: 200px;\n    height: 10px;\n    border: 1px solid white;\n  }\n  .preview-progress-inner {\n    height: 100%;\n    width: 0;\n    background: white;\n  }\n  [hidden] {\n    display: none;\n  }\n  </style>\n</head>\n<body>\n  <div class=\"preview-message\">\n    <div class=\"preview-progress-outer\"><div class=\"preview-progress-inner\"></div></div>\n  </div>\n  <div class=\"preview-message preview-error\" hidden>\n    <div class=\"preview-error-message\"></div>\n    <div>Go back to the original tab and try again</div>\n  </div>\n  <script>\n  (function() {\n    const err = (message) => {\n      document.querySelector(\".preview-error\").hidden = false;\n      document.querySelector(\".preview-error-message\").textContent = \"Error: \" + message;\n    };\n    if (!window.opener) {\n      err(\"window.opener is missing\");\n      return;\n    }\n    let hasRun = false;\n    const progressBar = document.querySelector(\".preview-progress-inner\");\n    const progressText = document.querySelector(\".preview-progress-text\");\n    window.addEventListener(\"message\", (e) => {\n      if (e.origin !== location.origin) return;\n      if (hasRun) return;\n      if (e.data.blob) {\n        hasRun = true;\n        const fr = new FileReader();\n        fr.onload = () => {\n          document.open();\n          document.write(fr.result);\n          document.close(); // fixes poor performance in firefox\n        };\n        fr.onerror = () => {\n          err(\"Something went wrong reading the file\");\n        };\n        fr.readAsText(e.data.blob);\n      }\n      if (typeof e.data.progress === \"number\") {\n        progressBar.style.width = (e.data.progress * 100) + \"%\";\n      }\n    });\n    window.opener.postMessage({\n      preview: \"hello\"\n    }, location.origin);\n  })();\n  </script>\n</body>\n</html>\n`;\nconst previewURL = URL.createObjectURL(new Blob([source], {\n  type: 'text/html'\n})) + '#do-not-share-this-link-it-will-not-work-for-others';\n\nconst windowToBlobMap = new WeakMap();\n\nclass Preview {\n  constructor () {\n    this.window = window.open(previewURL);\n    if (!this.window) {\n      throw new Error('Cannot open popup');\n    }\n  }\n\n  setContent (content) {\n    windowToBlobMap.set(this.window, content);\n    this.window.postMessage({\n      blob: content\n    }, location.origin);\n  }\n\n  setProgress (progress, text) {\n    this.window.postMessage({\n      progress,\n      text\n    }, location.origin);\n  }\n\n  close () {\n    this.window.close();\n  }\n}\n\nwindow.addEventListener('message', (e) => {\n  if (e.origin !== location.origin) {\n    return;\n  }\n  const data = e.data;\n  if (data.preview === 'hello') {\n    const source = e.source;\n    const blob = windowToBlobMap.get(source);\n    if (blob) {\n      source.postMessage({\n        blob\n      }, location.origin);\n    }\n  }\n});\n\nexport default Preview;\n","const deepClone = (obj) => {\n  if (obj instanceof Blob) {\n    return obj;\n  }\n  if (Array.isArray(obj)) {\n    const result = [];\n    for (const value of obj) {\n      result.push(deepClone(value));\n    }\n    return result;\n  }\n  if (obj && typeof obj === 'object') {\n    // TODO: there's probably some prototype pollution in here\n    const result = {};\n    for (const key of Object.keys(obj)) {\n      result[key] = deepClone(obj[key]);\n    }\n    return result;\n  }\n  // Primitive type\n  return obj;\n};\n\nexport default deepClone;\n","<script>\n  import {onDestroy} from 'svelte';\n  import {_} from '../locales/';\n  import {slide, fade} from 'svelte/transition';\n  import Section from './Section.svelte';\n  import Button from './Button.svelte';\n  import ImageInput from './ImageInput.svelte';\n  import CustomExtensions from './CustomExtensions.svelte';\n  import LearnMore from './LearnMore.svelte';\n  import Packager from './packager';\n  import writablePersistentStore from './persistent-store';\n  import fileStore from './file-store';\n  import {error, progress} from './stores';\n  import Preview from './preview';\n  import deepClone from './lib/deep-clone';\n  import assetCache from './cache';\n\n  export let projectData;\n\n  // JSON can't easily parse Infinity, so we'll just store large numbers instead\n  const ALMOST_INFINITY = 9999999999;\n\n  const cloudVariables = Object.values(projectData.project.analysis.stageVariables)\n    .filter(i => i.isCloud)\n    .map(i => i.name);\n\n  const defaultOptions = Packager.DEFAULT_OPTIONS();\n  defaultOptions.projectId = projectData.projectId || `p4-${projectData.uniqueId}`;\n  for (const variable of cloudVariables) {\n    defaultOptions.cloudVariables.custom[variable] = 'ws';\n  }\n  defaultOptions.app.packageName = Packager.getDefaultPackageNameFromFileName(projectData.title);\n  defaultOptions.app.windowTitle = Packager.getWindowTitleFromFileName(projectData.title);\n  const options = writablePersistentStore(`PackagerOptions.${projectData.uniqueId}`, defaultOptions);\n\n  let result = null;\n  let url = null;\n  $: $options, result = null, url = null;\n\n  let previewer = null;\n  $: if (previewer) {\n    previewer.setProgress($progress.progress, $progress.text);\n  }\n\n  const icon = fileStore.writableFileStore(`PackagerOptions.icon.${projectData.uniqueId}`);\n  $: $options.app.icon = $icon;\n\n  const customCursorIcon = fileStore.writableFileStore(`PackagerOptions.customCursorIcon.${projectData.uniqueId}`);\n  $: $options.cursor.custom = $customCursorIcon;\n\n  const loadingScreenImage = fileStore.writableFileStore(`PackagerOptions.loadingScreenImage.${projectData.uniqueId}`);\n  $: $options.loadingScreen.image = $loadingScreenImage;\n\n  const otherEnvironmentsInitiallyOpen = ![\n    'html',\n    'zip',\n    'electron-win32',\n    'webview-mac',\n    'electron-linux64'\n  ].includes($options.target);\n\n  const handleLargeAssetFetchProgress = ({detail}) => {\n    let thing;\n    if (detail.asset.startsWith('nwjs-')) {\n      thing = 'NW.js';\n    } else if (detail.asset.startsWith('electron-')) {\n      thing = 'Electron';\n    } else if (detail.asset === 'webview-mac') {\n      thing = 'WKWebView';\n    }\n    if (thing) {\n      $progress.text = $_('progress.loadingLargeAsset').replace('{thing}', thing);\n    }\n    $progress.progress = detail.progress;\n  };\n\n  const handleZipProgress = ({detail}) => {\n    $progress.text = $_('progress.compressingProject');\n    $progress.progress = detail.progress;\n  };\n\n  const downloadURL = (filename, url) => {\n    const link = document.createElement('a');\n    link.download = filename;\n    link.href = url;\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n  };\n\n  const runPackager = async (options) => {\n    try {\n      const packager = new Packager();\n      packager.options = options;\n      packager.project = projectData.project;\n\n      $progress.visible = true;\n      $progress.text = $_('progress.loadingScripts');\n\n      if (url) {\n        URL.revokeObjectURL(url);\n      }\n      result = null;\n      url = null;\n\n      packager.addEventListener('large-asset-fetch', handleLargeAssetFetchProgress);\n      packager.addEventListener('zip-progress', handleZipProgress);\n\n      result = await packager.package();\n      url = URL.createObjectURL(result.blob);\n    } catch (e) {\n      $error = e;\n    }\n    progress.reset();\n  };\n\n  const pack = async () => {\n    await runPackager(deepClone($options));\n    if (result) {\n      downloadURL(result.filename, url);\n    }\n  };\n\n  const preview = async () => {\n    previewer = new Preview();\n    const optionsClone = deepClone($options);\n    optionsClone.target = 'html';\n    await runPackager(optionsClone);\n    if (result) {\n      previewer.setContent(result.blob);\n    } else {\n      previewer.close();\n    }\n    previewer = null;\n  };\n\n  const reset = async () => {\n    if (confirm($_('options.confirmReload'))) {\n      try {\n        await assetCache.resetAll();\n        await fileStore.resetAll();\n      } catch (e) {\n        console.warn(e);\n      }\n      localStorage.clear();\n      location.reload();\n    }\n  };\n\n  onDestroy(() => {\n    if (url) {\n      URL.revokeObjectURL(url);\n    }\n  });\n</script>\n\n<style>\n  label {\n    display: block;\n    margin-bottom: 4px;\n  }\n  input[type=number] {\n    width: 60px;\n  }\n  input[type=text] {\n    width: 150px;\n  }\n  textarea {\n    box-sizing: border-box;\n    width: 100%;\n    min-width: 100%;\n    height: 200px;\n  }\n  .option-group {\n    margin-bottom: 12px;\n  }\n  input:invalid {\n    outline: 2px solid red;\n  }\n</style>\n\n<Section accent=\"#FFAB19\">\n  <h2>{$_('options.runtimeOptions')}</h2>\n\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.turbo}>\n    {$_('options.turbo')}\n  </label>\n  <label>\n    {$_('options.framerate')}\n    <input type=\"number\" min=\"0\" max=\"240\" bind:value={$options.framerate}>\n    <LearnMore slug=\"custom-fps\" />\n  </label>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.interpolation}>\n    {$_('options.interpolation')}\n    <LearnMore slug=\"interpolation\" />\n  </label>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.highQualityPen}>\n    {$_('options.highQualityPen')}\n    <LearnMore slug=\"high-quality-pen\" />\n  </label>\n  <label>\n    <input type=\"checkbox\" checked={$options.maxClones === ALMOST_INFINITY} on:change={(e) => {\n      $options.maxClones = e.target.checked ? ALMOST_INFINITY : 300;\n    }}>\n    {$_('options.infiniteClones')}\n    <LearnMore slug=\"infinite-clones\" />\n  </label>\n  <label>\n    <input type=\"checkbox\" checked={!$options.fencing} on:change={(e) => {\n      $options.fencing = !e.target.checked;\n    }}>\n    {$_('options.removeFencing')}\n    <LearnMore slug=\"remove-fencing\" />\n  </label>\n  <label>\n    <input type=\"checkbox\" checked={!$options.miscLimits} on:change={(e) => {\n      $options.miscLimits = !e.target.checked;\n    }}>\n    {$_('options.removeMiscLimits')}\n    <LearnMore slug=\"remove-misc-limits\" />\n  </label>\n  <label>\n    {$_('options.stageSize')}\n    <input type=\"number\" min=\"1\" max=\"4096\" step=\"1\" bind:value={$options.stageWidth}>\n    &times;\n    <input type=\"number\" min=\"1\" max=\"4096\" step=\"1\" bind:value={$options.stageHeight}>\n    <LearnMore slug=\"custom-stage-size\" />\n  </label>\n  <label>\n    {$_('options.username')}\n    <input type=\"text\" bind:value={$options.username}>\n  </label>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.autoplay}>\n    {$_('options.autoplay')}\n  </label>\n</Section>\n\n<Section accent=\"#9966FF\">\n  <h2>{$_('options.playerOptions')}</h2>\n\n  <label>\n    {$_('options.pageTitle')}\n    <input type=\"text\" bind:value={$options.app.windowTitle}>\n  </label>\n  <div>\n    {$_('options.icon')}\n    <ImageInput bind:file={$icon} previewSizes={[[64, 64], [32, 32], [16, 16]]} />\n  </div>\n\n  <h3>{$_('options.loadingScreen')}</h3>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.loadingScreen.progressBar}>\n    {$_('options.showProgressBar')}\n  </label>\n  <label>\n    {$_('options.loadingScreenText')}\n    <input type=\"text\" bind:value={$options.loadingScreen.text} placeholder={$_('options.loadingScreenTextPlaceholder')}>\n  </label>\n  <div class=\"option-group\">\n    {$_('options.loadingScreenImage')}\n    <!-- Display preview at image's native size -->\n    <ImageInput bind:file={$loadingScreenImage} previewSizes={[['', '']]} />\n  </div>\n  {#if $loadingScreenImage}\n    <label>\n      <input type=\"radio\" value=\"normal\" bind:group={$options.loadingScreen.imageMode}>\n      {$_('options.sizeNormal')}\n    </label>\n    <label>\n      <input type=\"radio\" value=\"stretch\" bind:group={$options.loadingScreen.imageMode}>\n      {$_('options.sizeStretch')}\n    </label>\n  {/if}\n\n  <h3>{$_('options.controls')}</h3>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.controls.greenFlag.enabled}>\n    {$_('options.showFlag')}\n  </label>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.controls.stopAll.enabled}>\n    {$_('options.showStop')}\n  </label>\n  <label>\n    <input type=\"checkbox\" bind:checked={$options.controls.fullscreen.enabled}>\n    {$_('options.showFullscreen')}\n  </label>\n  <p>{$_('options.controlsHelp')}</p>\n\n  <h3>{$_('options.colors')}</h3>\n  <label>\n    <input type=\"color\" bind:value={$options.appearance.background}>\n    {$_('options.backgroundColor')}\n  </label>\n  <label>\n    <input type=\"color\" bind:value={$options.appearance.foreground}>\n    {$_('options.foregroundColor')}\n  </label>\n  <label>\n    <input type=\"color\" bind:value={$options.appearance.accent}>\n    {$_('options.accentColor')}\n  </label>\n\n  <h3>{$_('options.interaction')}</h3>\n  <div class=\"option-group\">\n    <label>\n      <input type=\"radio\" bind:group={$options.cursor.type} value=\"auto\">\n      {$_('options.normalCursor')}\n    </label>\n    <label>\n      <input type=\"radio\" bind:group={$options.cursor.type} value=\"none\">\n      {$_('options.noCursor')}\n    </label>\n    <label>\n      <input type=\"radio\" bind:group={$options.cursor.type} value=\"custom\">\n      {$_('options.customCursor')}\n    </label>\n  </div>\n  {#if $options.cursor.type === 'custom'}\n    <div in:slide|self>\n      <ImageInput bind:file={$customCursorIcon} previewSizes={[[32, 32], [16, 16]]} />\n      <p>{$_('options.cursorHelp')}</p>\n    </div>\n  {/if}\n\n  <div class=\"option-group\">\n    <label>\n      <input type=\"checkbox\" bind:checked={$options.chunks.pointerlock}>\n      {$_('options.pointerlock')}\n    </label>\n    <div>\n      <a href=\"https://experiments.turbowarp.org/pointerlock/\" target=\"_blank\" rel=\"noopener\">\n        {$_('options.pointerlockHelp')}\n      </a>\n    </div>\n  </div>\n\n  <div class=\"option-group\">\n    <label>\n      <input type=\"checkbox\" bind:checked={$options.chunks.gamepad}>\n      {$_('options.gamepad')}\n    </label>\n    <div>\n      <a href=\"https://turbowarp.org/addons#gamepad\" target=\"_blank\" rel=\"noopener\">\n        {$_('options.gamepadHelp')}\n      </a>\n    </div>\n  </div>\n</Section>\n\n{#if cloudVariables.length > 0}\n  <Section accent=\"#FF8C1A\">\n    <h2>{$_('options.cloudVariables')}</h2>\n    <label>\n      {$_('options.mode')}\n      <select bind:value={$options.cloudVariables.mode}>\n        <option value=\"ws\">{$_('options.cloudVariables-ws')}</option>\n        <option value=\"local\">{$_('options.cloudVariables-local')}</option>\n        <option value=\"\">{$_('options.cloudVariables-ignore')}</option>\n        <option value=\"custom\">{$_('options.cloudVariables-custom')}</option>\n      </select>\n    </label>\n    {#if $options.cloudVariables.mode === \"custom\"}\n      <div transition:slide|local>\n        {#each cloudVariables as variable}\n          <label>\n            <select bind:value={$options.cloudVariables.custom[variable]}>\n              <option value=\"ws\">{$_('options.cloudVariables-ws')}</option>\n              <option value=\"local\">{$_('options.cloudVariables-local')}</option>\n              <option value=\"\">{$_('options.cloudVariables-ignore')}</option>\n            </select>\n            {variable}\n          </label>\n        {/each}\n      </div>\n    {/if}\n    {#if $options.cloudVariables.mode === 'ws' || $options.cloudVariables.mode === 'custom'}\n      <label transition:slide|local>\n        {$_('options.cloudVariablesHost')}\n        <input type=\"text\" bind:value={$options.cloudVariables.cloudHost}>\n      </label>\n    {/if}\n    <p>{$_('options.cloudVariables-ws-help')}</p>\n    <p>{$_('options.cloudVariables-local-help')}</p>\n    <p>{$_('options.cloudVariables-ignore-help')}</p>\n    <p>{$_('options.cloudVariables-custom-help')}</p>\n  </Section>\n{/if}\n\n<Section accent=\"#FF6680\">\n  <h2>{$_('options.advancedOptions')}</h2>\n  <details>\n    <summary>{$_('options.advancedSummary')}</summary>\n    <label>\n      <input type=\"checkbox\" bind:checked={$options.compiler.enabled}>\n      {$_('options.enableCompiler')}\n      <LearnMore slug=\"disable-compiler\" />\n    </label>\n    <label>\n      <input type=\"checkbox\" bind:checked={$options.compiler.warpTimer}>\n      {$_('options.warpTimer')}\n      <LearnMore slug=\"warp-timer\" />\n    </label>\n    <!-- Ignore because CustomExtensions will have a <textarea> inside it -->\n    <!-- svelte-ignore a11y-label-has-associated-control -->\n    <label>\n      {$_('options.customExtensions')}\n      <!-- TODO: use the user-facing documentation when that becomes available -->\n      <LearnMore slug=\"development/custom-extensions\" />\n      <CustomExtensions bind:value={$options.extensions} />\n    </label>\n    <label>\n      {$_('options.customJS')}\n      <textarea bind:value={$options.custom.js}></textarea>\n    </label>\n  </details>\n</Section>\n\n<Section accent=\"#0FBD8C\">\n  <h2>{$_('options.environment')}</h2>\n  <div class=\"option-group\">\n    <label>\n      <input type=\"radio\" bind:group={$options.target} value=\"html\">\n      {$_('options.html')}\n    </label>\n    <label>\n      <input type=\"radio\" bind:group={$options.target} value=\"zip\">\n      {$_('options.zip')}\n    </label>\n  </div>\n  <div class=\"option-group\">\n    <label>\n      <input type=\"radio\" bind:group={$options.target} value=\"electron-win32\">\n      {$_('options.application-win32').replace('{type}', 'Electron')}\n    </label>\n    <label>\n      <input type=\"radio\" bind:group={$options.target} value=\"webview-mac\">\n      {$_('options.application-mac').replace('{type}', 'WKWebView')}\n    </label>\n    <label>\n      <input type=\"radio\" bind:group={$options.target} value=\"electron-linux64\">\n      {$_('options.application-linux64').replace('{type}', 'Electron')}\n    </label>\n  </div>\n  <details open={otherEnvironmentsInitiallyOpen}>\n    <summary>{$_('options.otherEnvironments')}</summary>\n    <p>{$_('options.otherEnvironmentsHelp')}</p>\n    <div class=\"option-group\">\n      <label>\n        <input type=\"radio\" bind:group={$options.target} value=\"zip-one-asset\">\n        {$_('options.zip-one-asset')}\n      </label>\n    </div>\n    <div class=\"option-group\">\n      <label>\n        <input type=\"radio\" bind:group={$options.target} value=\"nwjs-win32\">\n        {$_('options.application-win32').replace('{type}', 'NW.js')}\n      </label>\n      <label>\n        <input type=\"radio\" bind:group={$options.target} value=\"nwjs-win64\">\n        {$_('options.application-win64').replace('{type}', 'NW.js')}\n      </label>\n      <label>\n        <input type=\"radio\" bind:group={$options.target} value=\"nwjs-mac\">\n        {$_('options.application-mac').replace('{type}', 'NW.js')}\n      </label>\n      <label>\n        <input type=\"radio\" bind:group={$options.target} value=\"nwjs-linux-x64\">\n        {$_('options.application-linux64').replace('{type}', 'NW.js')}\n      </label>\n    </div>\n  </details>\n</Section>\n\n{#if $options.target.startsWith('nwjs-') || $options.target.startsWith('electron-') || $options.target.startsWith('webview-')}\n  <div in:fade|local>\n    <Section accent=\"#FF661A\">\n      <h2>{$_('options.applicationSettings')}</h2>\n      <label>\n        {$_('options.packageName')}\n        <input type=\"text\" bind:value={$options.app.packageName} pattern=\"[a-zA-Z -]+\" minlength=\"1\">\n      </label>\n      <p>{$_('options.packageNameHelp')}</p>\n\n      {#if $options.target.includes('win')}\n        <div>\n          <h2>{$_('win.furtherSteps')}</h2>\n          <p>To change the icon of the executable file or create an installer program, download and run <a href=\"https://github.com/TurboWarp/packager-extras/releases\">TurboWarp Packager Extras</a> and select the output of this website.</p>\n          <p>All Windows applications generated by this site are unsigned, so users may see SmartScreen warnings when they try to launch it for the first time.</p>\n          {#if $options.target.endsWith('64')}\n            <p>The application will only run on 64-bit x86 computers.</p>\n          {:else if $options.target.endsWith('32')}\n            <p>The application will run on 32-bit and 64-bit x86 computers.</p>\n          {/if}\n        </div>\n      {:else if $options.target.includes('mac')}\n        <h2>{$_('mac.furtherSteps')}</h2>\n        <p>Due to Apple policy, packaging for their platforms is troublesome. You either have to:</p>\n        <ul>\n          <li>Instruct users to ignore scary Gatekeeper warnings by opening Finder > Navigating to the application > Right click > Open > Open (this website generates files that require this workaround)</li>\n          <li>Or pay Apple $100/year for a developer account to sign and notarize the app. If you have already paid for a developer account, <a href=\"https://github.com/TurboWarp/packager/discussions\">reach out on GitHub</a> and we'll help you set everything up (It is a very involved process).</li>\n        </ul>\n        {#if $options.target.includes('webview')}\n          <h2>About WKWebView</h2>\n          <p>WKWebView is the fastest and smallest way to package for macOS. It should run natively (without Rosetta) on both Intel and Apple silicon Macs running macOS 10.12 or later. However, it is only actively tested on macOS Big Sur on an Intel Mac.</p>\n          <p>Some features are not available in this environment:</p>\n          <ul>\n            <li>Exporting lists (but importing works)</li>\n            <li>Video sensing</li>\n            <li>Loudness</li>\n            <li>Very large projects may not work well</li>\n          </ul>\n          <p>If you need these features, use \"Plain HTML\" or \"NW.js macOS Application\" instead.</p>\n        {:else if $options.target.includes('nwjs')}\n          <h2>About NW.js</h2>\n          <p>NW.js runs natively on Intel Macs but will use Rosetta on Apple silicon Macs.</p>\n          <p>For further help and steps, see <a href=\"https://docs.nwjs.io/en/latest/For%20Users/Package%20and%20Distribute/#mac-os-x\">NW.js Documentation</a>.</p>\n        {/if}\n      {:else if $options.target.includes('linux')}\n        <h2>{$_('linux.furtherSteps')}</h2>\n        <p>Linux support is still experimental.</p>\n        <p>The application will only run on 64-bit x86 computers. 32-bit computers, Raspberry Pis, and other ARM devices will not work.</p>\n        {#if $options.target.includes('electron')}\n          <p>The application is started by running <code>start.sh</code>.</p>\n        {/if}\n        {#if $options.target.includes('nwjs')}\n          <p>For further help and steps, see <a href=\"https://docs.nwjs.io/en/latest/For%20Users/Package%20and%20Distribute/#linux\">NW.js Documentation</a>.</p>\n        {/if}\n      {/if}\n    </Section>\n  </div>\n{/if}\n\n<Section>\n  <Button on:click={pack} disabled={$progress.visible} text={$_('options.package')} />\n  <Button on:click={preview} disabled={$progress.visible} secondary text={$_('options.preview')} />\n  <Button on:click={reset} danger text={$_('options.reset')} />\n</Section>\n\n{#if result && url}\n  <Section center>\n    <p>\n      <a href={url} download={result.filename}>\n        {$_('options.download')\n          .replace('{filename}', result.filename)\n          .replace('{size}', (result.blob.size / 1000 / 1000).toFixed(2))}\n      </a>\n    </p>\n  </Section>\n{:else if !$progress.visible}\n  <Section caption>\n    <p>{$_('options.downloadsWillAppearHere')}</p>\n  </Section>\n{/if}\n","<script>\n  export let progress = 0;\n  export let text = '';\n</script>\n\n<style>\n  .progress {\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n  }\n  .bar-outer {\n    width: 200px;\n    height: 10px;\n    border: 1px solid currentColor;\n    margin-bottom: 4px;\n    background: black;\n  }\n  :global([theme=\"dark\"]) .bar-outer {\n    background: transparent;\n  }\n  .bar-inner {\n    height: 100%;\n    width: 0;\n    background: white;\n  }\n  .text {\n    font-style: italic;\n  }\n</style>\n\n<div class=\"progress\">\n  <div class=\"bar-outer\">\n    <div class=\"bar-inner\" style={`width:${progress*100}%`}></div>\n  </div>\n  <div class=\"text\">\n    {text}\n  </div>\n</div>\n\n","// Legacy Edge does not support TextDecoder\nexport default typeof TextDecoder === 'function';\n","<script>\n  import {_} from '../locales/';\n  import ComplexMessage from './ComplexMessage.svelte';\n  import {fade} from 'svelte/transition';\n  import Section from './Section.svelte';\n  import SelectProject from './SelectProject.svelte';\n  import SelectLocale from './SelectLocale.svelte';\n  import SelectTheme from './SelectTheme.svelte';\n  import PackagerOptions from './PackagerOptions.svelte';\n  import Progress from './Progress.svelte';\n  import Button from './Button.svelte';\n  import {error, progress, theme} from './stores';\n  import {UserError} from './errors';\n  import isSupported from './lib/browser-support';\n  import {LONG_NAME, FEEDBACK_GITHUB, FEEDBACK_SCRATCH, SOURCE_CODE} from './brand';\n\n  let projectData;\n\n  const darkMedia = window.matchMedia('(prefers-color-scheme: dark)');\n  let systemTheme = darkMedia.matches ? 'dark' : 'light';\n  if (darkMedia.addEventListener) {\n    darkMedia.addEventListener('change', () => {\n      systemTheme = darkMedia.matches ? 'dark' : 'light';\n    });\n  }\n  $: document.documentElement.setAttribute('theme', $theme === 'system' ? systemTheme : $theme);\n\n  $: if ($error) {\n    document.body.setAttribute('modal-visible', '');\n    console.error($error);\n  } else {\n    document.body.removeAttribute('modal-visible');\n  }\n\n  const closeModal = () => {\n    $error = null;\n  };\n  const onKeyDown = (e) => {\n    if (e.key === 'Escape') {\n      closeModal();\n    }\n  };\n</script>\n\n<style>\n  :global([theme=\"dark\"]) {\n    background: #111;\n    color: #eee;\n    color-scheme: dark;\n  }\n  :global(a) {\n    color: blue;\n  }\n  :global(a:active) {\n    color: red;\n  }\n  :global([theme=\"dark\"]) :global(a) {\n    color: #4af;\n  }\n  :global([modal-visible]) {\n    overflow: hidden;\n  }\n  :global(p), :global(h1), :global(h2) {\n    margin: 12px 0;\n  }\n  :global(summary) {\n    cursor: pointer;\n  }\n  main {\n    font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n    padding-bottom: 10px;\n  }\n  footer {\n    text-align: center;\n  }\n  .modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: rgba(0, 0, 0, 0.75);\n  }\n  footer > div {\n    margin-top: 12px;\n  }\n  .footer-spacer {\n    margin: 0 3px;\n  }\n</style>\n\n<svelte:window on:keydown={onKeyDown} />\n\n<main>\n  <Section accent=\"#ff4c4c\">\n    <h1>{LONG_NAME}</h1>\n    <p>{$_('p4.description1')}</p>\n    <p>\n      <ComplexMessage\n        message={$_('p4.description2')}\n        values={{\n          embedding: {\n            text: $_('p4.description2-embedding'),\n            href: 'https://docs.turbowarp.org/embedding'\n          }\n        }}\n      />\n    </p>\n    <p>\n      <ComplexMessage\n        message={$_('p4.description3')}\n        values={{\n          onScratch: {\n            text: $_('p4.description3-scratch'),\n            href: FEEDBACK_SCRATCH\n          },\n          onGitHub: {\n            text: $_('p4.description3-github'),\n            href: FEEDBACK_GITHUB\n          }\n        }}\n      />\n    </p>\n  </Section>\n\n  {#if !isSupported}\n    <Section accent=\"#4C97FF\">\n      <h2>Browser not supported</h2>\n      <p>Please update your browser to use this site.</p>\n    </Section>\n  {:else}\n    <SelectProject bind:projectData />\n  {/if}\n\n  {#if projectData}\n    <div in:fade>\n      <PackagerOptions projectData={projectData} />\n    </div>\n  {/if}\n\n  {#if $error}\n    <div class=\"modal\" on:click|self={closeModal} on:key>\n      <Section modal>\n        <h2>{$_('p4.error')}</h2>\n        {#if $error instanceof UserError}\n          <p>{$error.message}</p>\n          <p>\n            <Button on:click={closeModal} text={$_('p4.close')} />\n          </p>\n        {:else}\n          <p>\n            {$_('p4.errorMessage').replace('{error}', $error)}\n          </p>\n          <p>\n            <Button on:click={closeModal} text={$_('p4.close')} />\n            <a href={FEEDBACK_SCRATCH}>{$_('p4.reportBug')}</a>\n          </p>\n        {/if}\n      </Section>\n    </div>\n  {/if}\n\n  {#if $progress.visible}\n    <Section center>\n      <Progress progress={$progress.progress} text={$progress.text} />\n    </Section>\n  {/if}\n\n  <footer>\n    <div>\n      <a href=\"privacy.html\">{$_('p4.privacy')}</a>\n      <span class=\"footer-spacer\">-</span>\n      <a href={FEEDBACK_SCRATCH}>{$_('p4.feedback')}</a>\n      <span class=\"footer-spacer\">-</span>\n      <a href={SOURCE_CODE}>{$_('p4.sourceCode')}</a>\n    </div>\n    <div>\n      <a href=\"https://fosshost.org/\">{$_('p4.fosshost')}</a>\n    </div>\n    <div>\n      <SelectTheme />\n    </div>\n    <div>\n      <SelectLocale />\n    </div>\n  </footer>\n</main>\n","export default __webpack_public_path__ + \"sw.js\";","const PLAUSIBLE_API = process.env.PLAUSIBLE_API;\nconst PLAUSIBLE_DOMAIN = process.env.PLAUSIBLE_DOMAIN;\nconst enabled =\n  PLAUSIBLE_API &&\n  PLAUSIBLE_DOMAIN &&\n  (location.protocol === 'http:' || location.protocol === 'https:') &&\n  location.hostname === PLAUSIBLE_DOMAIN &&\n  navigator.doNotTrack !== '1';\n\nconst sendEvent = eventName => {\n  if (!enabled) {\n    return;\n  }\n  setTimeout(() => {\n    const xhr = new XMLHttpRequest();\n    xhr.open('POST', PLAUSIBLE_API, true);\n    xhr.setRequestHeader('Content-Type', 'text/plain');\n    xhr.send(JSON.stringify({\n      n: eventName,\n      u: location.origin,\n      d: PLAUSIBLE_DOMAIN,\n      r: null\n    }));\n  });\n};\n\nsendEvent('pageview');\n\nexport default {\n  sendEvent\n};\n","import P4 from './P4.svelte';\nimport serviceWorker from '!!file-loader?name=sw.js!./sw.js';\nimport './analytics';\n\nconst app = new P4({\n  target: document.getElementById('app')\n});\n\ndocument.body.setAttribute('p4-loaded', '');\n\nif (process.env.ENABLE_SERVICE_WORKER && 'serviceWorker' in navigator) {\n  navigator.serviceWorker.register(serviceWorker)\n    .then(() => {\n      console.log('SW registered');\n    }).catch((error) => {\n      console.log('SW error', error);\n    });\n}\n"],"sourceRoot":""}